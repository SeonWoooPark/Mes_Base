### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 1: ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡ (ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì œê±°)

```
ì „ì œì¡°ê±´: ì‚¬ìš©ìê°€ ìˆ˜ì£¼ê´€ë¦¬ í™”ë©´ì— ì ‘ì†í•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ "ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡" ë²„íŠ¼ í´ë¦­
2. ìˆ˜ì£¼ ë“±ë¡ ëª¨ë‹¬/í˜ì´ì§€ê°€ ì—´ë¦¼
3. ìˆ˜ì£¼ íƒ€ì… ì„ íƒ:
   - ë‚´ìˆ˜(D) / ìˆ˜ì¶œ(E) / ìƒ˜í”Œ(S) / ìˆ˜ë¦¬(R) ì¤‘ ì„ íƒ
   - ì˜ˆì‹œ: "ë‚´ìˆ˜" ì„ íƒ
4. ê³ ê° ì •ë³´ ì…ë ¥:
   - ê³ ê°ì½”ë“œ: CUST001 (ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒ)
   - ê³ ê°ëª…: ì‚¼ì„±ì „ì (ìë™ ì…ë ¥)
   - ë‹´ë‹¹ì: ê¹€ë‹´ë‹¹ì
   - ì—°ë½ì²˜: 02-1234-5678
5. ìˆ˜ì£¼ ê¸°ë³¸ ì •ë³´ ì…ë ¥:
   - ë‚©ê¸°ì¼: 2024-12-31 ì„ íƒ
   - ìš°ì„ ìˆœìœ„: ë†’ìŒ ì„ íƒ
   - ì˜ì—…ë‹´ë‹¹ì: ì´ì˜ì—… ì„ íƒ
   - ë¹„ê³ : ì—°ë§ ë‚©í’ˆ ìš”ì²­
6. ìˆ˜ì£¼ í’ˆëª© ì¶”ê°€:
   - ì œí’ˆì½”ë“œ: FG2412001 ì„ íƒ
   - ì œí’ˆëª…: ê°¤ëŸ­ì‹œ ì¼€ì´ìŠ¤ (ìë™ ì…ë ¥)
   - ìˆ˜ëŸ‰: 1000
   - ë‹¨ê°€: 15000
   - ê¸ˆì•¡: 15,000,000 (ìë™ ê³„ì‚°)
7. "ì €ì¥" ë²„íŠ¼ í´ë¦­
8. ì‹œìŠ¤í…œì´ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦:
   - ìˆ˜ì£¼ë²ˆí˜¸ ìë™ ìƒì„±: SOD24120001 (ë‚´ìˆ˜, 2024ë…„ 12ì›”, ì²« ë²ˆì§¸)
   - ìˆ˜ì£¼ íƒ€ì…ë³„ ê²€ì¦ ìˆ˜í–‰ (ë‚´ìˆ˜: ê¸°ë³¸ ê²€ì¦ë§Œ)
   - ë‚©ê¸°ì¼ ìœ íš¨ì„± í™•ì¸
   - ì œí’ˆ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
   - ì´ ê¸ˆì•¡ ê³„ì‚°: 15,000,000ì›
9. ê²€ì¦ ì„±ê³µ ì‹œ:
   - ìˆ˜ì£¼ ì •ë³´ ì €ì¥ (ìƒíƒœ: ëŒ€ê¸°)
   - ë“±ë¡ ì´ë ¥ ê¸°ë¡
   - "ë‚´ìˆ˜ ìˆ˜ì£¼ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. (ìˆ˜ì£¼ë²ˆí˜¸: SOD24120001)" ë©”ì‹œì§€ í‘œì‹œ
   - ìˆ˜ì£¼ ëª©ë¡ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ë©° ìƒˆ ìˆ˜ì£¼ê°€ ëª©ë¡ì— ì¶”ê°€ë¨
   - ë°”ë¡œ "ìƒì‚°ì§€ì‹œ ìƒì„±" ë²„íŠ¼ì´ í™œì„±í™”ë¨ (ìŠ¹ì¸ ë‹¨ê³„ ìƒëµ)

í›„ì†ì¡°ê±´: ìƒˆë¡œìš´ ìˆ˜ì£¼ê°€ ì‹œìŠ¤í…œì— ë“±ë¡ë˜ê³  ì¦‰ì‹œ ìƒì‚° ì§€ì‹œ ìƒì„± ê°€ëŠ¥ ìƒíƒœê°€ ë¨
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 2: ìˆ˜ì£¼ ì •ë³´ ìˆ˜ì •

```
ì „ì œì¡°ê±´: ì‚¬ìš©ìê°€ ìˆ˜ì •í•  ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ì—ì„œ "ìˆ˜ì •" ë²„íŠ¼ í´ë¦­
2. ìˆ˜ì£¼ ìˆ˜ì • ëª¨ë‹¬ì´ ì—´ë¦¬ë©° ê¸°ì¡´ ì •ë³´ê°€ í‘œì‹œë¨
3. ìˆ˜ì • ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸:
   - ëŒ€ê¸° ìƒíƒœ: ëª¨ë“  ì •ë³´ ìˆ˜ì • ê°€ëŠ¥
   - ìƒì‚°ì¤‘ ìƒíƒœ: í’ˆëª© ì •ë³´, ë‚©ê¸°ì¼ ìˆ˜ì • ë¶ˆê°€ (ê³ ê° ì •ë³´, ë¹„ê³ ë§Œ ìˆ˜ì • ê°€ëŠ¥)
   - ì™„ë£Œ/ì·¨ì†Œ ìƒíƒœ: ìˆ˜ì • ë¶ˆê°€
4. ì‚¬ìš©ìê°€ ë³€ê²½í•  ì •ë³´ ì…ë ¥:
   - ë‚©ê¸°ì¼: 2024-12-31 â†’ 2025-01-15ë¡œ ë³€ê²½
   - ìš°ì„ ìˆœìœ„: ë†’ìŒ â†’ ê¸´ê¸‰ìœ¼ë¡œ ë³€ê²½
   - í’ˆëª© ìˆ˜ì •:
     * ê¸°ì¡´ í’ˆëª© ìˆ˜ëŸ‰ ë³€ê²½: 1000 â†’ 1200
     * ìƒˆ í’ˆëª© ì¶”ê°€: FG2412002 ê°¤ëŸ­ì‹œ ì¶©ì „ê¸° 500ê°œ
     * ê¸°ì¡´ í’ˆëª© ì‚­ì œ: ì²´í¬ë°•ìŠ¤ë¡œ ì‚­ì œ í‘œì‹œ
5. ìˆ˜ì • ì‚¬ìœ  ì…ë ¥: "ê³ ê° ìš”ì²­ì— ì˜í•œ ìˆ˜ëŸ‰ ì¦ê°€ ë° í’ˆëª© ì¶”ê°€"
6. "ì €ì¥" ë²„íŠ¼ í´ë¦­
7. ì‹œìŠ¤í…œì´ ë³€ê²½ì‚¬í•­ ê²€ì¦:
   - ìƒì‚° ìƒíƒœë³„ ìˆ˜ì • ê¶Œí•œ í™•ì¸
   - ì‹ ê·œ ì œí’ˆ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
   - ì´ ê¸ˆì•¡ ì¬ê³„ì‚°
8. ê²€ì¦ ì„±ê³µ ì‹œ:
   - ìˆ˜ì£¼ ì •ë³´ ì—…ë°ì´íŠ¸
   - ë³€ê²½ ì´ë ¥ ìƒì„¸ ê¸°ë¡:
     * ë‚©ê¸°ì¼: 2024-12-31 â†’ 2025-01-15
     * ìš°ì„ ìˆœìœ„: ë†’ìŒ â†’ ê¸´ê¸‰
     * í’ˆëª©: ê°¤ëŸ­ì‹œ ì¼€ì´ìŠ¤ ìˆ˜ëŸ‰ 1000 â†’ 1200
     * í’ˆëª©: ê°¤ëŸ­ì‹œ ì¶©ì „ê¸° 500ê°œ ì¶”ê°€
   - "ìˆ˜ì£¼ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤ (3ê°œ í•­ëª© ë³€ê²½)" ë©”ì‹œì§€ í‘œì‹œ

í›„ì†ì¡°ê±´: ìˆ˜ì£¼ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë˜ê³  ëª¨ë“  ë³€ê²½ì‚¬í•­ì´ ì¶”ì  ê°€ëŠ¥í•œ ì´ë ¥ìœ¼ë¡œ ê¸°ë¡ë¨
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 3: ìˆ˜ì£¼ ì‚­ì œ (ë…¼ë¦¬ ì‚­ì œ)

```
ì „ì œì¡°ê±´: ì‚­ì œí•  ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ì—ì„œ "ì‚­ì œ" ë²„íŠ¼ í´ë¦­
2. í™•ì¸ ëŒ€í™”ìƒì í‘œì‹œ:
   - "ìˆ˜ì£¼ 'SOD24120001 - ì‚¼ì„±ì „ì'ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
   - "ìƒì‚°ì´ ì§„í–‰ ì¤‘ì¸ ê²½ìš° ê´€ë ¨ ìƒì‚° ì§€ì‹œë„ í•¨ê»˜ ì·¨ì†Œë©ë‹ˆë‹¤."
3. ì‚­ì œ ì‚¬ìœ  ì…ë ¥: "ê³ ê° ì£¼ë¬¸ ì·¨ì†Œ ìš”ì²­"
4. "í™•ì¸" ë²„íŠ¼ í´ë¦­
5. ì‹œìŠ¤í…œì´ ì‚­ì œ ê°€ëŠ¥ì„± ê²€ì‚¬:
   - ì™„ë£Œëœ ìˆ˜ì£¼ì¸ì§€ í™•ì¸
   - ìƒì‚° ì§„í–‰ë¥  í™•ì¸ (50% ì´ìƒ ì§„í–‰ ì‹œ ì‚­ì œ ë¶ˆê°€)
   - ê´€ë ¨ ìƒì‚° ì§€ì‹œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
6. ì‚­ì œ ê°€ëŠ¥í•œ ê²½ìš°:
   - ê´€ë ¨ ìƒì‚° ì§€ì‹œ ìë™ ì·¨ì†Œ
   - ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ì·¨ì†Œ'ë¡œ ë³€ê²½ (ë…¼ë¦¬ ì‚­ì œ)
   - ì‚­ì œ ì´ë ¥ ê¸°ë¡
   - "ìˆ˜ì£¼ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤" ë©”ì‹œì§€ í‘œì‹œ
   - ëª©ë¡ì—ì„œ í•´ë‹¹ ìˆ˜ì£¼ê°€ 'ì·¨ì†Œ' ìƒíƒœë¡œ í‘œì‹œ (íšŒìƒ‰ ì²˜ë¦¬)
7. ì‚­ì œ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°:
   - "ìƒì‚°ì´ 50% ì´ìƒ ì§„í–‰ëœ ìˆ˜ì£¼ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ë“±ì˜ êµ¬ì²´ì  ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ

í›„ì†ì¡°ê±´: ìˆ˜ì£¼ê°€ ë…¼ë¦¬ì ìœ¼ë¡œ ì‚­ì œë˜ì–´ ì·¨ì†Œ ìƒíƒœê°€ ë˜ê³  ê´€ë ¨ ìƒì‚° ì§€ì‹œë„ í•¨ê»˜ ì·¨ì†Œë¨
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 4: ìˆ˜ì£¼ ì´ë ¥ ìƒì„¸ ì¡°íšŒ

```
ì „ì œì¡°ê±´: ì´ë ¥ì„ ì¡°íšŒí•  ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ì—ì„œ "ì´ë ¥ì¡°íšŒ" ë²„íŠ¼ í´ë¦­
2. ìˆ˜ì£¼ ì´ë ¥ ì¡°íšŒ ëª¨ë‹¬ì´ ì—´ë¦¼
3. ìˆ˜ì£¼ ê¸°ë³¸ ì •ë³´ í‘œì‹œ:
   - ìˆ˜ì£¼ë²ˆí˜¸: SOD24120001
   - ê³ ê°ëª…: ì‚¼ì„±ì „ì
   - í˜„ì¬ ìƒíƒœ: ìƒì‚°ì¤‘
   - ì´ ê¸ˆì•¡: 18,500,000ì›
4. ì´ë ¥ í•„í„° ì˜µì…˜:
   - ì•¡ì…˜ í•„í„°: ì „ì²´/ë“±ë¡/ìˆ˜ì •/ì‚­ì œ/ìƒì‚°ì‹œì‘/ì™„ë£Œ
   - ë‚ ì§œ ë²”ìœ„: ì‹œì‘ì¼ ~ ì¢…ë£Œì¼
   - ì‚¬ìš©ì í•„í„°: íŠ¹ì • ì‚¬ìš©ì
5. ì‹œê°„ìˆœ ì´ë ¥ ëª©ë¡ í‘œì‹œ:
```

ğŸ“… 2024-12-01 10:30 | ğŸ‘¤ ê¹€ì˜ì—… | â• ë“±ë¡
ìš”ì•½: ìˆ˜ì£¼ê°€ ì‹ ê·œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.

ğŸ“… 2024-12-02 14:20 | ğŸ‘¤ ì´ê´€ë¦¬ì | âœï¸ ìˆ˜ì •  
 ìš”ì•½: ë‚©ê¸°ì¼, ìš°ì„ ìˆœìœ„ ë“± 3ê°œ í•­ëª©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
ë³€ê²½ì‚¬í•­:
â€¢ ë‚©ê¸°ì¼: 2024-12-31 â†’ 2025-01-15
â€¢ ìš°ì„ ìˆœìœ„: ë†’ìŒ â†’ ê¸´ê¸‰  
 â€¢ í’ˆëª©: ê°¤ëŸ­ì‹œ ì¼€ì´ìŠ¤ ìˆ˜ëŸ‰ 1000 â†’ 1200
ì‚¬ìœ : ê³ ê° ìš”ì²­ì— ì˜í•œ ìˆ˜ëŸ‰ ì¦ê°€

ğŸ“… 2024-12-03 09:15 | ğŸ‘¤ ë°•ìƒì‚°ì | ğŸ­ ìƒì‚°ì‹œì‘
ìš”ì•½: ìƒì‚° ì§€ì‹œê°€ ìƒì„±ë˜ì–´ ìƒì‚°ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
ìƒì‚°ì§€ì‹œë²ˆí˜¸: PO24120001

```
6. ì‚¬ìš©ìê°€ íŠ¹ì • ì´ë ¥ í•­ëª© í´ë¦­ ì‹œ:
- ë³€ê²½ ì‚¬í•­ ìƒì„¸ ì •ë³´ íŒì—…
- ë³€ê²½ ì „/í›„ ê°’ ë¹„êµ í‘œì‹œ
- ë³€ê²½ ì‚¬ìœ  ë° ë‹´ë‹¹ì ì •ë³´
7. ì´ë ¥ ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥:
- Excel/PDF í˜•íƒœë¡œ ì´ë ¥ ë³´ê³ ì„œ ìƒì„±
- ê°ì‚¬ ëª©ì ì˜ ìƒì„¸ ì´ë ¥ ë¬¸ì„œ

í›„ì†ì¡°ê±´: ìˆ˜ì£¼ì˜ ëª¨ë“  ë³€ê²½ ì´ë ¥ì„ ì‹œê°„ìˆœìœ¼ë¡œ ì¶”ì í•˜ì—¬ íˆ¬ëª…í•œ ì´ë ¥ ê´€ë¦¬ ì œê³µ
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 5: ìƒì‚° ì§€ì‹œ ìƒì„± (ìŠ¹ì¸ ì—†ì´ ì§ì ‘ ìƒì„±)

````
ì „ì œì¡°ê±´: ëŒ€ê¸° ìƒíƒœì˜ ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ì—ì„œ "ìƒì‚°ì§€ì‹œ ìƒì„±" ë²„íŠ¼ í´ë¦­
2. ìƒì‚° ì§€ì‹œ ìƒì„± ëª¨ë‹¬ì´ ì—´ë¦¼:
   - ìˆ˜ì£¼ ì •ë³´ í‘œì‹œ (ì½ê¸° ì „ìš©)
   - ê³„íš ì‹œì‘ì¼ ì…ë ¥ í•„ë“œ
   - ì˜ˆìƒ ì™„ë£Œì¼ í‘œì‹œ (ìë™ ê³„ì‚°)
   - BOM ê²€ì¦ ê²°ê³¼ í‘œì‹œ
3. ê³„íš ì‹œì‘ì¼ ì…ë ¥: 2024-12-15 ì„ íƒ
4. ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ê²€ì¦:
   - BOM ì¡´ì¬ ì—¬ë¶€: âœ… ëª¨ë“  ì œí’ˆ BOM í™•ì¸ë¨
   - ë‚©ê¸°ì¼ ì—¬ìœ : âœ… ì¶©ë¶„í•œ ìƒì‚° ì‹œê°„ í™•ë³´ (15ì¼)
   - ì˜ˆìƒ ì™„ë£Œì¼: 2024-12-28 (ìë™ ê³„ì‚°)
5. "ìƒì‚°ì§€ì‹œ ìƒì„±" ë²„íŠ¼ í´ë¦­
6. ì‹œìŠ¤í…œì´ ìµœì¢… ê²€ì¦:
   - ìˆ˜ì£¼ ìƒíƒœ í™•ì¸ (ëŒ€ê¸° ìƒíƒœë§Œ ê°€ëŠ¥)
   - ëª¨ë“  ì œí’ˆì˜ BOM ì¬í™•ì¸
   - ê³„íš ì‹œì‘ì¼ê³¼ ë‚©ê¸°ì¼ ê°„ì˜ ì—¬ìœ  ì‹œê°„ í™•ì¸
7. ê²€ì¦ ì„±ê³µ ì‹œ:
   - ìƒì‚° ì§€ì‹œë²ˆí˜¸ ìë™ ìƒì„±: PO24120001
   - ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ìƒì‚°ì¤‘'ìœ¼ë¡œ ë³€ê²½
   - ìƒì‚° ì‹œì‘ ì´ë ¥ ê¸°ë¡
   - "ìƒì‚° ì§€ì‹œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. (ìƒì‚°ì§€ì‹œë²ˆí˜¸: PO24120001)" ë©”ì‹œì§€ í‘œì‹œ
   - ìƒì‚°ê´€ë¦¬ ì‹œìŠ¤í…œìœ¼ë¡œ ë°ì´í„° ìë™ ì—°ê³„

í›„ì†ì¡°ê±´: ìŠ¹ì¸ ë‹¨ê³„ ì—†ì´ ë°”ë¡œ ìƒì‚° ì§€ì‹œê°€ ìƒì„±ë˜ì–´ ìƒì‚° í”„ë¡œì„¸ìŠ¤ ì‹œì‘
``` INVALID_ORDER_NO
   - ì˜¤ë¥˜ ë©”ì‹œì§€: "ìˆ˜ì£¼ë²ˆí˜¸ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì˜ˆ: SOD24120001)"
   - ì˜¬ë°”ë¥¸ í˜•ì‹ ì•ˆë‚´
4. ì˜¬ë°”ë¥¸ ìˆ˜ì£¼ë²ˆí˜¸ë¡œ ì¬ì‹œë„: "SOD24120001"
5. ì‹œìŠ¤í…œì´ ì¬ê²€ì¦:
   - í˜•ì‹ ê²€ì¦: í†µê³¼
   - ë…„ì›” ìœ íš¨ì„±: 2024ë…„ 12ì›” â†’ ìœ íš¨
   - ì‹œí€€ìŠ¤ ë²”ìœ„: 0001 â†’ ìœ íš¨
6. ê²€ì¦ ì„±ê³µ í›„ ì •ìƒ ì²˜ë¦¬

í›„ì†ì¡°ê±´: ì˜ëª»ëœ ìˆ˜ì£¼ë²ˆí˜¸ë¡œ ì¸í•œ ë°ì´í„° ì˜¤ë¥˜ ë°©ì§€
````

---

## ğŸ“Š ìˆ˜ì£¼ë²ˆí˜¸ ì±„ë²ˆ ì‹œìŠ¤í…œ êµ¬í˜„ ê°€ì´ë“œ

### ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```sql
-- ìˆ˜ì£¼ë²ˆí˜¸ ì‹œí€€ìŠ¤ ê´€ë¦¬ í…Œì´ë¸”
CREATE TABLE order_sequences (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  prefix VARCHAR(10) NOT NULL,           -- SOD2412, SOE2412 ë“±
  sequence_no INT NOT NULL DEFAULT 0,    -- í˜„ì¬ ì‹œí€€ìŠ¤ ë²ˆí˜¸
  last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  UNIQUE KEY uk_prefix (prefix),
  INDEX idx_prefix_updated (prefix, last_updated)
);

-- ìˆ˜ì£¼ë²ˆí˜¸ ì´ë ¥ í…Œì´ë¸” (ì„ íƒì‚¬í•­)
CREATE TABLE order_number_history (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  order_no VARCHAR(11) NOT NULL,         -- ìƒì„±ëœ ìˆ˜ì£¼ë²ˆí˜¸
  order_type ENUM('DOMESTIC', 'EXPORT', 'SAMPLE', 'REPAIR') NOT NULL,
  prefix VARCHAR(10) NOT NULL,           -- SOD2412 ë“±
  sequence_no INT NOT NULL,              -- í•´ë‹¹ ì‹œí€€ìŠ¤ ë²ˆí˜¸
  created_by VARCHAR(50) NOT NULL,       -- ìƒì„±ì
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  UNIQUE KEY uk_order_no (order_no),
  INDEX idx_order_type_created (order_type, created_at),
  INDEX idx_prefix_sequence (prefix, sequence_no)
);
```

### ğŸ”§ ì‹œí€€ìŠ¤ ë™ì‹œì„± ì œì–´

```typescript
// ê³ ì„±ëŠ¥ ì‹œí€€ìŠ¤ ê´€ë¦¬ë¥¼ ìœ„í•œ ìµœì í™”
export class OptimizedSequenceRepository implements SequenceRepository {
  private sequenceCache = new Map<string, number>();
  private readonly CACHE_SIZE = 100; // í•œ ë²ˆì— 100ê°œì”© ë¯¸ë¦¬ í• ë‹¹

  async getNextSequence(prefix: string): Promise<number> {
    // 1. ìºì‹œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì‹œí€€ìŠ¤ í™•ì¸
    const cachedSequence = this.getCachedSequence(prefix);
    if (cachedSequence > 0) {
      return cachedSequence;
    }

    // 2. ìºì‹œ ë¯¸ìŠ¤ ì‹œ DBì—ì„œ ë°°ì¹˜ë¡œ ì‹œí€€ìŠ¤ í• ë‹¹
    return await this.allocateSequenceBatch(prefix);
  }

  private getCachedSequence(prefix: string): number {
    const cached = this.sequenceCache.get(prefix);
    if (cached && cached > 0) {
      this.sequenceCache.set(prefix, cached - 1);
      return cached;
    }
    return 0;
  }

  private async allocateSequenceBatch(prefix: string): Promise<number> {
    return await this.dataSource.transaction(async (txn: any) => {
      // í˜„ì¬ ì‹œí€€ìŠ¤ ì¡°íšŒ ë° ë°°ì¹˜ ì—…ë°ì´íŠ¸
      const result = await txn.query(
        `UPDATE order_sequences 
         SET sequence_no = sequence_no + ? 
         WHERE prefix = ?`,
        [this.CACHE_SIZE, prefix]
      );

      if (result.affectedRows === 0) {
        // ìƒˆë¡œìš´ prefix ìƒì„±
        await txn.query(
          "INSERT INTO order_sequences (prefix, sequence_no) VALUES (?, ?)",
          [prefix, this.CACHE_SIZE]
        );

        // ìºì‹œì— 1~100 ì €ì¥
        this.sequenceCache.set(prefix, this.CACHE_SIZE - 1);
        return 1;
      } else {
        // ê¸°ì¡´ ì‹œí€€ìŠ¤ì—ì„œ í• ë‹¹
        const currentSeq = await txn.query(
          "SELECT sequence_no FROM order_sequences WHERE prefix = ?",
          [prefix]
        );

        const lastAllocated = currentSeq[0].sequence_no;
        const firstNew = lastAllocated - this.CACHE_SIZE + 1;

        // ìºì‹œì— í• ë‹¹ëœ ë²”ìœ„ ì €ì¥
        this.sequenceCache.set(prefix, lastAllocated - 1);
        return firstNew;
      }
    });
  }
}
```

### ğŸ“ˆ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```typescript
// ìˆ˜ì£¼ë²ˆí˜¸ ì±„ë²ˆ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
export class OrderNoGeneratorMetrics {
  private generationCount = new Map<string, number>();
  private generationTime = new Map<string, number[]>();

  recordGeneration(prefix: string, duration: number): void {
    // ìƒì„± íšŸìˆ˜ ì¦ê°€
    this.generationCount.set(
      prefix,
      (this.generationCount.get(prefix) || 0) + 1
    );

    // ìƒì„± ì‹œê°„ ê¸°ë¡ (ìµœê·¼ 100ê±´)
    const times = this.generationTime.get(prefix) || [];
    times.push(duration);
    if (times.length > 100) {
      times.shift();
    }
    this.generationTime.set(prefix, times);
  }

  getMetrics(): OrderNoMetrics {
    const metrics: OrderNoMetrics = {
      totalGenerations: 0,
      averageTime: 0,
      prefixStats: [],
    };

    for (const [prefix, count] of this.generationCount) {
      const times = this.generationTime.get(prefix) || [];
      const avgTime =
        times.length > 0 ? times.reduce((a, b) => a + b, 0) / times.length : 0;

      metrics.totalGenerations += count;
      metrics.prefixStats.push({
        prefix,
        count,
        averageTime: avgTime,
      });
    }

    metrics.averageTime =
      metrics.prefixStats.reduce((sum, stat) => sum + stat.averageTime, 0) /
      metrics.prefixStats.length;

    return metrics;
  }
}

interface OrderNoMetrics {
  totalGenerations: number;
  averageTime: number;
  prefixStats: {
    prefix: string;
    count: number;
    averageTime: number;
  }[];
}
```

ì´ì œ ìˆ˜ì£¼ë²ˆí˜¸ ìë™ ì±„ë²ˆ ì‹œìŠ¤í…œì´ ì™„ë²½í•˜ê²Œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

## ğŸ¯ **ê°œì„ ëœ ì±„ë²ˆ ì‹œìŠ¤í…œì˜ í•µì‹¬ íŠ¹ì§•**

### 1. **ì²´ê³„ì ì¸ ì±„ë²ˆ ë£°**

- **SO + íƒ€ì…ì½”ë“œ + ë…„ì›” + ì‹œí€€ìŠ¤** í˜•ì‹
- ì›”ë³„ ìë™ ë¦¬ì…‹ìœ¼ë¡œ ê´€ë¦¬ ìš©ì´ì„± í™•ë³´
- ìˆ˜ì£¼ íƒ€ì…ë³„ ë…ë¦½ì ì¸ ì±„ë²ˆ (ë‚´ìˆ˜/ìˆ˜ì¶œ/ìƒ˜í”Œ/ìˆ˜ë¦¬)

### 2. **ë™ì‹œì„± ì œì–´ ë° ì„±ëŠ¥ ìµœì í™”**

- íŠ¸ëœì­ì…˜ ê¸°ë°˜ ì›ìì  ì‹œí€€ìŠ¤ ì¦ê°€
- ë°°ì¹˜ í• ë‹¹ìœ¼ë¡œ DB ë¶€í•˜ ìµœì†Œí™”
- ìºì‹œ í™œìš©ìœ¼ë¡œ ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„

### 3. **ê°•ë ¥í•œ ê²€ì¦ ì‹œìŠ¤í…œ**

- ìˆ˜ì£¼ë²ˆí˜¸ í˜•ì‹ ê²€ì¦
- ë…„ì›” ìœ íš¨ì„± í™•ì¸
- íŒŒì‹±ì„ í†µí•œ ì •ë³´ ì¶”ì¶œ

### 4. **í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°**

- ìƒˆë¡œìš´ ìˆ˜ì£¼ íƒ€ì… ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥
- ì±„ë²ˆ ë£° ë³€ê²½ ì‹œ ìœ ì—°í•œ ëŒ€ì‘
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ê¸°ëŠ¥ ë‚´ì¥

ì´ ì‹œìŠ¤í…œì„ í†µí•´ **SOD24120001**, **SOE24120015**, **SOS24120003** ê°™ì€ ì˜ë¯¸ ìˆëŠ” ìˆ˜ì£¼ë²ˆí˜¸ê°€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì–´ ì—…ë¬´ íš¨ìœ¨ì„±ì´ í¬ê²Œ í–¥ìƒë  ê²ƒì…ë‹ˆë‹¤.### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 1: ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡ (ìˆ˜ì£¼ íƒ€ì…ë³„)

````
ì „ì œì¡°ê±´: ì‚¬ìš©ìê°€ ìˆ˜ì£¼ê´€ë¦¬ í™”ë©´ì— ì ‘ì†í•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ "ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡" ë²„íŠ¼ í´ë¦­
2. ìˆ˜ì£¼ ë“±ë¡ ëª¨ë‹¬/í˜ì´ì§€ê°€ ì—´ë¦¼
3. ìˆ˜ì£¼ íƒ€ì… ì„ íƒ:
   - ë‚´ìˆ˜(D) / ìˆ˜ì¶œ(E) / ìƒ˜í”Œ(S) / ìˆ˜ë¦¬(R) ì¤‘ ì„ íƒ
   - ì˜ˆì‹œ: "ë‚´ìˆ˜" ì„ íƒ
4. ê³ ê°# MES ìˆ˜ì£¼ê´€ë¦¬ ì‹œìŠ¤í…œ í´ë¦° ì•„í‚¤í…ì²˜

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

**ì œì¡°ì‹¤í–‰ì‹œìŠ¤í…œ(MES)ì˜ ìˆ˜ì£¼ê´€ë¦¬ ëª¨ë“ˆ - ê³ ê° ì£¼ë¬¸ë¶€í„° ìƒì‚° ì§€ì‹œê¹Œì§€ì˜ í†µí•© ê´€ë¦¬**

---

## ğŸ—ï¸ Domain Layer (ë„ë©”ì¸ ê³„ì¸µ)

### ğŸ“¦ 1. Entities (ì—”í‹°í‹°) - í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ê°ì²´

#### Order (ìˆ˜ì£¼) ì—”í‹°í‹°
```typescript
// domain/entities/Order.ts
export class Order {
  constructor(
    private readonly id: OrderId,
    private readonly orderNo: string,
    private readonly orderType: OrderType, // ìˆ˜ì£¼ íƒ€ì… ì¶”ê°€
    private readonly customer: Customer,
    private readonly orderDate: Date,
    private readonly deliveryDate: Date,
    private readonly status: OrderStatus,
    private readonly items: OrderItem[],
    private readonly totalAmount: number,
    private readonly currency: Currency,
    private readonly priority: OrderPriority,
    private readonly notes: string,
    private readonly salesPerson: string,
    private readonly id_create: string,
    private readonly id_updated: string,
    private readonly dt_create: Date,
    private readonly dt_update: Date
  ) {
    this.validateOrder();
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™: ìˆ˜ì£¼ ì •ë³´ ê²€ì¦
  private validateOrder(): void {
    if (!this.orderNo || this.orderNo.trim().length === 0) {
      throw new Error('ìˆ˜ì£¼ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
    }
    if (!this.customer) {
      throw new Error('ê³ ê° ì •ë³´ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
    }
    if (this.deliveryDate <= this.orderDate) {
      throw new Error('ë‚©ê¸°ì¼ì€ ìˆ˜ì£¼ì¼ë³´ë‹¤ ë‚˜ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
    }
    if (this.items.length === 0) {
      throw new Error('ìˆ˜ì£¼ í’ˆëª©ì€ ìµœì†Œ 1ê°œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
    }
    if (this.totalAmount < 0) {
      throw new Error('ì´ ê¸ˆì•¡ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
    }
    if (!this.id_create || this.id_create.trim().length === 0) {
      throw new Error('ìƒì„±ìëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
    }
    if (!this.id_updated || this.id_updated.trim().length === 0) {
      throw new Error('ìˆ˜ì •ìëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
    }
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ìˆ˜ì£¼ ìŠ¹ì¸ ê°€ëŠ¥ ì—¬ë¶€
  public canBeApproved(): boolean {
    return this.status === OrderStatus.PENDING &&
           this.items.every(item => item.isValid()) &&
           this.isWithinDeliveryCapacity();
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ìƒì‚° ì§€ì‹œ ê°€ëŠ¥ ì—¬ë¶€
  public canCreateProductionOrder(): boolean {
    return this.status === OrderStatus.PENDING &&
           this.items.every(item => item.hasValidBOM());
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ë‚©ê¸° ì§€ì—° ì—¬ë¶€
  public isDelayed(): boolean {
    return new Date() > this.deliveryDate &&
           this.status !== OrderStatus.COMPLETED &&
           this.status !== OrderStatus.CANCELLED;
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ì·¨ì†Œ ê°€ëŠ¥ ì—¬ë¶€
  public canBeCancelled(): boolean {
    return this.status === OrderStatus.PENDING;
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ë‚©ê¸° ìš©ëŸ‰ í™•ì¸
  private isWithinDeliveryCapacity(): boolean {
    // í•´ë‹¹ ë‚©ê¸°ì¼ì˜ ìƒì‚° ìš©ëŸ‰ í™•ì¸ ë¡œì§
    return true; // ì‹¤ì œë¡œëŠ” ProductionCapacityService í˜¸ì¶œ
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ì´ ê¸ˆì•¡ ê³„ì‚°
  public calculateTotalAmount(): number {
    return this.items.reduce((total, item) => total + item.getAmount(), 0);
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ìˆ˜ì£¼ ìƒíƒœ ë³€ê²½
  public changeStatus(newStatus: OrderStatus, reason?: string): Order {
    this.validateStatusTransition(newStatus);

    return new Order(
      this.id,
      this.orderNo,
      this.orderType,
      this.customer,
      this.orderDate,
      this.deliveryDate,
      newStatus,
      this.items,
      this.totalAmount,
      this.currency,
      this.priority,
      this.notes,
      this.salesPerson,
      this.id_create,
      this.id_updated,
      this.dt_create,
      new Date()
    );
  }

  // ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™: ìƒíƒœ ì „í™˜ ê²€ì¦
  private validateStatusTransition(newStatus: OrderStatus): void {
    const validTransitions: Map<OrderStatus, OrderStatus[]> = new Map([
      [OrderStatus.PENDING, [OrderStatus.IN_PRODUCTION, OrderStatus.CANCELLED]],
      [OrderStatus.IN_PRODUCTION, [OrderStatus.COMPLETED, OrderStatus.CANCELLED]],
      [OrderStatus.COMPLETED, []],
      [OrderStatus.CANCELLED, []]
    ]);

    const allowedTransitions = validTransitions.get(this.status) || [];
    if (!allowedTransitions.includes(newStatus)) {
      throw new Error(`${this.status}ì—ì„œ ${newStatus}ë¡œ ìƒíƒœ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.`);
    }
  }

  // Getters
  public getId(): OrderId { return this.id; }
  public getOrderNo(): string { return this.orderNo; }
  public getOrderType(): OrderType { return this.orderType; }
  public getCustomer(): Customer { return this.customer; }
  public getOrderDate(): Date { return this.orderDate; }
  public getDeliveryDate(): Date { return this.deliveryDate; }
  public getStatus(): OrderStatus { return this.status; }
  public getItems(): OrderItem[] { return this.items; }
  public getTotalAmount(): number { return this.totalAmount; }
  public getCurrency(): Currency { return this.currency; }
  public getPriority(): OrderPriority { return this.priority; }
  public getNotes(): string { return this.notes; }
  public getSalesPerson(): string { return this.salesPerson; }
  public getIdCreate(): string { return this.id_create; }
  public getIdUpdated(): string { return this.id_updated; }
  public getDtCreate(): Date { return this.dt_create; }
  public getDtUpdate(): Date { return this.dt_update; }
}

// ìˆ˜ì£¼ë²ˆí˜¸ ìë™ ì±„ë²ˆ ì„œë¹„ìŠ¤
export interface OrderNoGenerator {
  generateOrderNo(orderType?: OrderType): Promise<string>;
  validateOrderNo(orderNo: string): boolean;
  parseOrderNo(orderNo: string): OrderNoInfo;
}

export interface OrderNoInfo {
  prefix: string;
  year: string;
  month: string;
  sequence: number;
  orderType: OrderType;
  isValid: boolean;
}

export enum OrderType {
  DOMESTIC = 'DOMESTIC',     // ë‚´ìˆ˜
  EXPORT = 'EXPORT',         // ìˆ˜ì¶œ
  SAMPLE = 'SAMPLE',         // ìƒ˜í”Œ
  REPAIR = 'REPAIR'          // ìˆ˜ë¦¬
}

export class DefaultOrderNoGenerator implements OrderNoGenerator {
  constructor(
    private orderRepository: OrderRepository,
    private sequenceRepository: SequenceRepository
  ) {}

  async generateOrderNo(orderType: OrderType = OrderType.DOMESTIC): Promise<string> {
    const today = new Date();
    const year = today.getFullYear().toString().slice(-2); // 24 (2024ë…„)
    const month = (today.getMonth() + 1).toString().padStart(2, '0'); // 01-12

    // ìˆ˜ì£¼ íƒ€ì…ë³„ ì ‘ë‘ì‚¬
    const typePrefix = this.getTypePrefixByOrderType(orderType);

    // ê¸°ë³¸ ì ‘ë‘ì‚¬: SO (Sales Order)
    const basePrefix = 'SO';

    // ì „ì²´ ì ‘ë‘ì‚¬ êµ¬ì„±: SO + íƒ€ì… + ë…„ì›”
    const fullPrefix = `${basePrefix}${typePrefix}${year}${month}`;

    // í•´ë‹¹ ë…„ì›”ì˜ ë§ˆì§€ë§‰ ì‹œí€€ìŠ¤ ë²ˆí˜¸ ì¡°íšŒ (ì›ìì  ì—°ì‚°)
    const nextSequence = await this.sequenceRepository.getNextSequence(fullPrefix);

    // ì‹œí€€ìŠ¤ë¥¼ 4ìë¦¬ë¡œ íŒ¨ë”©
    const sequenceStr = nextSequence.toString().padStart(4, '0');

    return `${fullPrefix}${sequenceStr}`;
  }

  validateOrderNo(orderNo: string): boolean {
    // ìˆ˜ì£¼ë²ˆí˜¸ í˜•ì‹ ê²€ì¦: SO[D/E/S/R]YYMM0000
    const pattern = /^SO[DESR]\d{6}$/;

    if (!pattern.test(orderNo)) {
      return false;
    }

    // ë…„ì›” ìœ íš¨ì„± ê²€ì¦
    const yearPart = orderNo.substring(3, 5);
    const monthPart = orderNo.substring(5, 7);

    const year = parseInt('20' + yearPart);
    const month = parseInt(monthPart);

    const currentYear = new Date().getFullYear();

    // ë…„ë„ëŠ” 2020ë…„ ì´í›„, í˜„ì¬ ë…„ë„ + 1ë…„ ì´ë‚´
    if (year < 2020 || year > currentYear + 1) {
      return false;
    }

    // ì›”ì€ 01-12
    if (month < 1 || month > 12) {
      return false;
    }

    return true;
  }

  parseOrderNo(orderNo: string): OrderNoInfo {
    if (!this.validateOrderNo(orderNo)) {
      return {
        prefix: '',
        year: '',
        month: '',
        sequence: 0,
        orderType: OrderType.DOMESTIC,
        isValid: false
      };
    }

    const prefix = orderNo.substring(0, 2); // SO
    const typeCode = orderNo.substring(2, 3); // D/E/S/R
    const year = orderNo.substring(3, 5); // YY
    const month = orderNo.substring(5, 7); // MM
    const sequence = parseInt(orderNo.substring(7, 11)); // 0000

    return {
      prefix: `${prefix}${typeCode}`,
      year: '20' + year,
      month: month,
      sequence: sequence,
      orderType: this.getOrderTypeByCode(typeCode),
      isValid: true
    };
  }

  private getTypePrefixByOrderType(orderType: OrderType): string {
    switch (orderType) {
      case OrderType.DOMESTIC:
        return 'D'; // Domestic
      case OrderType.EXPORT:
        return 'E'; // Export
      case OrderType.SAMPLE:
        return 'S'; // Sample
      case OrderType.REPAIR:
        return 'R'; // Repair
      default:
        return 'D';
    }
  }

  private getOrderTypeByCode(code: string): OrderType {
    switch (code) {
      case 'D':
        return OrderType.DOMESTIC;
      case 'E':
        return OrderType.EXPORT;
      case 'S':
        return OrderType.SAMPLE;
      case 'R':
        return OrderType.REPAIR;
      default:
        return OrderType.DOMESTIC;
    }
  }
}

// ì‹œí€€ìŠ¤ ê´€ë¦¬ë¥¼ ìœ„í•œ ë³„ë„ Repository
export interface SequenceRepository {
  getNextSequence(prefix: string): Promise<number>;
  getCurrentSequence(prefix: string): Promise<number>;
  resetSequence(prefix: string): Promise<void>;
}

export class DefaultSequenceRepository implements SequenceRepository {
  constructor(private dataSource: any) {} // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì ì ˆí•œ ë°ì´í„° ì†ŒìŠ¤ ì£¼ì…

  async getNextSequence(prefix: string): Promise<number> {
    // íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì›ìì ìœ¼ë¡œ ì‹œí€€ìŠ¤ ì¦ê°€
    return await this.dataSource.transaction(async (txn: any) => {
      // í˜„ì¬ ì‹œí€€ìŠ¤ ì¡°íšŒ
      const currentSeq = await txn.query(
        'SELECT sequence_no FROM order_sequences WHERE prefix = ? FOR UPDATE',
        [prefix]
      );

      let nextSequence: number;

      if (currentSeq.length === 0) {
        // í•´ë‹¹ prefixì˜ ì‹œí€€ìŠ¤ê°€ ì—†ìœ¼ë©´ 1ë¶€í„° ì‹œì‘
        nextSequence = 1;
        await txn.query(
          'INSERT INTO order_sequences (prefix, sequence_no, last_updated) VALUES (?, ?, NOW())',
          [prefix, nextSequence]
        );
      } else {
        // ê¸°ì¡´ ì‹œí€€ìŠ¤ + 1
        nextSequence = currentSeq[0].sequence_no + 1;
        await txn.query(
          'UPDATE order_sequences SET sequence_no = ?, last_updated = NOW() WHERE prefix = ?',
          [nextSequence, prefix]
        );
      }

      return nextSequence;
    });
  }

  async getCurrentSequence(prefix: string): Promise<number> {
    const result = await this.dataSource.query(
      'SELECT sequence_no FROM order_sequences WHERE prefix = ?',
      [prefix]
    );

    return result.length > 0 ? result[0].sequence_no : 0;
  }

  async resetSequence(prefix: string): Promise<void> {
    await this.dataSource.query(
      'UPDATE order_sequences SET sequence_no = 0, last_updated = NOW() WHERE prefix = ?',
      [prefix]
    );
  }
}

/**
 * ìˆ˜ì£¼ë²ˆí˜¸ ì±„ë²ˆ ë£° ì •ì˜
 *
 * ğŸ·ï¸ ì±„ë²ˆ í˜•ì‹: SO + [íƒ€ì…ì½”ë“œ] + [ë…„ì›”] + [ì‹œí€€ìŠ¤]
 *
 * ğŸ“‹ ìƒì„¸ ê·œì¹™:
 * - SO: Sales Order (ê³ ì •)
 * - íƒ€ì…ì½”ë“œ: D(ë‚´ìˆ˜), E(ìˆ˜ì¶œ), S(ìƒ˜í”Œ), R(ìˆ˜ë¦¬)
 * - ë…„ì›”: YY + MM (24ë…„ 12ì›” = 2412)
 * - ì‹œí€€ìŠ¤: 0001~9999 (ì›”ë³„ ë¦¬ì…‹)
 *
 * ğŸ¯ ì±„ë²ˆ ì˜ˆì‹œ:
 * - SOD24120001: 2024ë…„ 12ì›” ë‚´ìˆ˜ ì²« ë²ˆì§¸ ìˆ˜ì£¼
 * - SOE24120015: 2024ë…„ 12ì›” ìˆ˜ì¶œ 15ë²ˆì§¸ ìˆ˜ì£¼
 * - SOS24120003: 2024ë…„ 12ì›” ìƒ˜í”Œ 3ë²ˆì§¸ ìˆ˜ì£¼
 * - SOR24120007: 2024ë…„ 12ì›” ìˆ˜ë¦¬ 7ë²ˆì§¸ ìˆ˜ì£¼
 *
 * ğŸ”§ ê´€ë¦¬ ê¸°ëŠ¥:
 * - ì›”ë³„ ìë™ ì‹œí€€ìŠ¤ ë¦¬ì…‹
 * - íƒ€ì…ë³„ ë…ë¦½ì ì¸ ì±„ë²ˆ
 * - ìˆ˜ì£¼ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì¦
 * - ìˆ˜ì£¼ë²ˆí˜¸ íŒŒì‹± ë° ì •ë³´ ì¶”ì¶œ
 * - ë™ì‹œì„± ì œì–´ (íŠ¸ëœì­ì…˜ ê¸°ë°˜)
 */

export class OrderId {
  constructor(private readonly value: string) {
    if (!value || value.length === 0) {
      throw new Error('Order IDëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
    }
  }

  public getValue(): string { return this.value; }
  public equals(other: OrderId): boolean {
    return this.value === other.value;
  }
}

export enum OrderStatus {
  PENDING = 'PENDING',           // ëŒ€ê¸°
  IN_PRODUCTION = 'IN_PRODUCTION', // ìƒì‚°ì¤‘
  COMPLETED = 'COMPLETED',       // ì™„ë£Œ
  CANCELLED = 'CANCELLED'        // ì·¨ì†Œ
}

export enum OrderPriority {
  LOW = 'LOW',         // ë‚®ìŒ
  NORMAL = 'NORMAL',   // ë³´í†µ
  HIGH = 'HIGH',       // ë†’ìŒ
  URGENT = 'URGENT'    // ê¸´ê¸‰
}

export class Customer {
  constructor(
    public readonly code: string,
    public readonly name: string,
    public readonly contactPerson: string,
    public readonly phoneNumber: string,
    public readonly email: string,
    public readonly address: string
  ) {}
}

export class Currency {
  constructor(
    public readonly code: string,    // KRW, USD, EUR ë“±
    public readonly name: string,    // ì›í™”, ë‹¬ëŸ¬, ìœ ë¡œ ë“±
    public readonly symbol: string   // â‚©, $, â‚¬ ë“±
  ) {}
}

// ìˆ˜ì£¼ í’ˆëª© ì—”í‹°í‹°
export class OrderItem {
  constructor(
    private readonly id: string,
    private readonly productId: string,
    private readonly productCode: string,
    private readonly productName: string,
    private readonly quantity: number,
    private readonly unit: string,
    private readonly unitPrice: number,
    private readonly amount: number,
    private readonly deliveryDate: Date,
    private readonly notes: string
  ) {
    this.validateOrderItem();
  }

  private validateOrderItem(): void {
    if (!this.productId || this.productId.trim().length === 0) {
      throw new Error('ì œí’ˆ IDëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
    }
    if (this.quantity <= 0) {
      throw new Error('ìˆ˜ëŸ‰ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.');
    }
    if (this.unitPrice < 0) {
      throw new Error('ë‹¨ê°€ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
    }
    if (this.amount !== this.quantity * this.unitPrice) {
      throw new Error('ê¸ˆì•¡ì´ ìˆ˜ëŸ‰ Ã— ë‹¨ê°€ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
    }
  }

  public isValid(): boolean {
    return this.quantity > 0 && this.unitPrice >= 0;
  }

  public hasValidBOM(): boolean {
    // ì‹¤ì œë¡œëŠ” BOMServiceë¥¼ í†µí•´ í•´ë‹¹ ì œí’ˆì˜ BOM ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    return true;
  }

  // Getters
  public getId(): string { return this.id; }
  public getProductId(): string { return this.productId; }
  public getProductCode(): string { return this.productCode; }
  public getProductName(): string { return this.productName; }
  public getQuantity(): number { return this.quantity; }
  public getUnit(): string { return this.unit; }
  public getUnitPrice(): number { return this.unitPrice; }
  public getAmount(): number { return this.amount; }
  public getDeliveryDate(): Date { return this.deliveryDate; }
  public getNotes(): string { return this.notes; }
}

// ìˆ˜ì£¼ ì´ë ¥ ì—”í‹°í‹°
export class OrderHistory {
  constructor(
    private readonly id: string,
    private readonly orderId: OrderId,
    private readonly action: OrderHistoryAction,
    private readonly changedFields: ChangedField[],
    private readonly userId: string,
    private readonly userName: string,
    private readonly timestamp: Date,
    private readonly reason?: string
  ) {}

  public getId(): string { return this.id; }
  public getOrderId(): OrderId { return this.orderId; }
  public getAction(): OrderHistoryAction { return this.action; }
  public getChangedFields(): ChangedField[] { return this.changedFields; }
  public getUserId(): string { return this.userId; }
  public getUserName(): string { return this.userName; }
  public getTimestamp(): Date { return this.timestamp; }
  public getReason(): string | undefined { return this.reason; }
}

export enum OrderHistoryAction {
  CREATE = 'CREATE',
  UPDATE = 'UPDATE',
  DELETE = 'DELETE',
  CANCEL = 'CANCEL',
  START_PRODUCTION = 'START_PRODUCTION',
  COMPLETE = 'COMPLETE'
}

export class ChangedField {
  constructor(
    public readonly fieldName: string,
    public readonly oldValue: any,
    public readonly newValue: any
  ) {}
}
````

---

## ğŸ¯ Application Layer (ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ)

### ğŸ”„ Use Cases (ìœ ìŠ¤ì¼€ì´ìŠ¤)

#### 1. ìˆ˜ì£¼ ëª©ë¡ ì¡°íšŒ UseCase

```typescript
// application/usecases/order/GetOrderListUseCase.ts
export interface GetOrderListRequest {
  page: number;
  pageSize: number;
  sortBy?: string;
  sortDirection?: "asc" | "desc";
  searchKeyword?: string; // ëª¨ë“  ì»¬ëŸ¼ í†µí•© ê²€ìƒ‰
  filters?: OrderFilter[];
}

export interface OrderFilter {
  field: "status" | "customer" | "priority" | "deliveryDate" | "salesPerson";
  value: any;
}

export interface GetOrderListResponse {
  orders: OrderListItem[];
  totalCount: number;
  currentPage: number;
  totalPages: number;
  hasNextPage: boolean;
}

export interface OrderListItem {
  id: string;
  orderNo: string;
  customerName: string;
  orderDate: Date;
  deliveryDate: Date;
  status: string;
  statusDisplay: string;
  priority: string;
  priorityDisplay: string;
  totalAmount: number;
  currency: string;
  salesPerson: string;
  itemCount: number;
  isDelayed: boolean;
  daysUntilDelivery: number;
  lastUpdated: Date;
}

export class GetOrderListUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderPresenter: OrderPresenter
  ) {}

  async execute(request: GetOrderListRequest): Promise<GetOrderListResponse> {
    // 1. ì…ë ¥ ê²€ì¦
    this.validateRequest(request);

    // 2. ê²€ìƒ‰ ì¡°ê±´ êµ¬ì„±
    const searchCriteria = this.buildSearchCriteria(request);

    // 3. ìˆ˜ì£¼ ëª©ë¡ ì¡°íšŒ (í˜ì´ì§• í¬í•¨)
    const orders = await this.orderRepository.findByPageWithCriteria(
      searchCriteria,
      request.page,
      request.pageSize
    );

    // 4. ì „ì²´ ê°œìˆ˜ ì¡°íšŒ
    const totalCount = await this.orderRepository.countByCriteria(
      searchCriteria
    );

    // 5. í”„ë ˆì  í…Œì´ì…˜ ë°ì´í„° ë³€í™˜
    const orderListItems = orders.map((order) => {
      const daysUntilDelivery = this.calculateDaysUntilDelivery(
        order.getDeliveryDate()
      );

      return {
        id: order.getId().getValue(),
        orderNo: order.getOrderNo(),
        customerName: order.getCustomer().name,
        orderDate: order.getOrderDate(),
        deliveryDate: order.getDeliveryDate(),
        status: order.getStatus(),
        statusDisplay: this.orderPresenter.getStatusDisplayName(
          order.getStatus()
        ),
        priority: order.getPriority(),
        priorityDisplay: this.orderPresenter.getPriorityDisplayName(
          order.getPriority()
        ),
        totalAmount: order.getTotalAmount(),
        currency: order.getCurrency().symbol,
        salesPerson: order.getSalesPerson(),
        itemCount: order.getItems().length,
        isDelayed: order.isDelayed(),
        daysUntilDelivery,
        lastUpdated: order.getDtUpdate(),
      };
    });

    // 6. í˜ì´ì§• ì •ë³´ ê³„ì‚°
    const totalPages = Math.ceil(totalCount / request.pageSize);
    const hasNextPage = request.page < totalPages;

    return {
      orders: orderListItems,
      totalCount,
      currentPage: request.page,
      totalPages,
      hasNextPage,
    };
  }

  private validateRequest(request: GetOrderListRequest): void {
    if (request.page < 1) {
      throw new Error("í˜ì´ì§€ ë²ˆí˜¸ëŠ” 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
    }
    if (request.pageSize < 1 || request.pageSize > 1000) {
      throw new Error("í˜ì´ì§€ í¬ê¸°ëŠ” 1-1000 ë²”ìœ„ì—¬ì•¼ í•©ë‹ˆë‹¤.");
    }
  }

  private buildSearchCriteria(
    request: GetOrderListRequest
  ): OrderSearchCriteria {
    return {
      searchKeyword: request.searchKeyword,
      filters: request.filters || [],
      sortBy: request.sortBy || "orderDate",
      sortDirection: request.sortDirection || "desc",
    };
  }

  private calculateDaysUntilDelivery(deliveryDate: Date): number {
    const today = new Date();
    const diffTime = deliveryDate.getTime() - today.getTime();
    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  }
}
```

#### 2. ìˆ˜ì£¼ ë“±ë¡ UseCase

```typescript
// application/usecases/order/CreateOrderUseCase.ts
export interface CreateOrderRequest {
  orderType: OrderType; // ë‚´ìˆ˜/ìˆ˜ì¶œ/ìƒ˜í”Œ/ìˆ˜ë¦¬ êµ¬ë¶„ ì¶”ê°€
  customer: {
    code: string;
    name: string;
    contactPerson: string;
    phoneNumber: string;
    email: string;
    address: string;
  };
  deliveryDate: Date;
  priority: OrderPriority;
  notes: string;
  salesPerson: string;
  items: CreateOrderItemRequest[];
  id_create: string; // ìƒì„±ì ID
}

export interface CreateOrderItemRequest {
  productId: string;
  productCode: string;
  productName: string;
  quantity: number;
  unit: string;
  unitPrice: number;
  deliveryDate: Date;
  notes: string;
}

export interface CreateOrderResponse {
  orderId: string;
  orderNo: string;
  orderType: string;
  success: boolean;
  message: string;
}

export class CreateOrderUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderHistoryRepository: OrderHistoryRepository,
    private orderNoGenerator: OrderNoGenerator,
    private productService: ProductService
  ) {}

  async execute(request: CreateOrderRequest): Promise<CreateOrderResponse> {
    // 1. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦
    await this.validateBusinessRules(request);

    // 2. ìˆ˜ì£¼ë²ˆí˜¸ ìë™ ì±„ë²ˆ (ìˆ˜ì£¼ íƒ€ì… ë°˜ì˜)
    const orderNo = await this.orderNoGenerator.generateOrderNo(
      request.orderType
    );

    // ìˆ˜ì£¼ë²ˆí˜¸ ìœ íš¨ì„± ì¬ê²€ì¦
    if (!this.orderNoGenerator.validateOrderNo(orderNo)) {
      throw new Error("ìˆ˜ì£¼ë²ˆí˜¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    }

    // 3. ìˆ˜ì£¼ í’ˆëª© ìƒì„±
    const orderItems = await this.createOrderItems(request.items);

    // 4. ì´ ê¸ˆì•¡ ê³„ì‚°
    const totalAmount = orderItems.reduce(
      (total, item) => total + item.getAmount(),
      0
    );

    // 5. ìˆ˜ì£¼ ì—”í‹°í‹° ìƒì„±
    const orderId = new OrderId(this.generateOrderId());
    const customer = new Customer(
      request.customer.code,
      request.customer.name,
      request.customer.contactPerson,
      request.customer.phoneNumber,
      request.customer.email,
      request.customer.address
    );
    const currency = new Currency("KRW", "ì›í™”", "â‚©"); // ê¸°ë³¸ í†µí™”

    const now = new Date();
    const order = new Order(
      orderId,
      orderNo,
      request.orderType, // ìˆ˜ì£¼ íƒ€ì… ì¶”ê°€
      customer,
      now, // ìˆ˜ì£¼ì¼ì€ í˜„ì¬ ë‚ ì§œ
      request.deliveryDate,
      OrderStatus.PENDING, // ì´ˆê¸° ìƒíƒœëŠ” ëŒ€ê¸°
      orderItems,
      totalAmount,
      currency,
      request.priority,
      request.notes,
      request.salesPerson,
      request.id_create, // ìƒì„±ì
      request.id_create, // ìˆ˜ì •ì (ì‹ ê·œ ë“±ë¡ ì‹œ ìƒì„±ìì™€ ë™ì¼)
      now, // dt_create
      now // dt_update
    );

    // 6. ì €ì¥
    await this.orderRepository.save(order);

    // 7. ì´ë ¥ ê¸°ë¡
    const history = new OrderHistory(
      this.generateHistoryId(),
      orderId,
      OrderHistoryAction.CREATE,
      [],
      request.id_create,
      request.id_create, // ìƒì„±ìëª… (ì‹¤ì œë¡œëŠ” ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ í•„ìš”)
      new Date(),
      `ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡ (${this.getOrderTypeDisplayName(request.orderType)})`
    );
    await this.orderHistoryRepository.save(history);

    return {
      orderId: orderId.getValue(),
      orderNo: orderNo,
      orderType: this.getOrderTypeDisplayName(request.orderType),
      success: true,
      message: `ìˆ˜ì£¼ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. (ìˆ˜ì£¼ë²ˆí˜¸: ${orderNo})`,
    };
  }

  private async validateBusinessRules(
    request: CreateOrderRequest
  ): Promise<void> {
    // ë‚©ê¸°ì¼ ê²€ì¦
    const today = new Date();
    if (request.deliveryDate <= today) {
      throw new Error("ë‚©ê¸°ì¼ì€ ì˜¤ëŠ˜ ë‚ ì§œë³´ë‹¤ ë‚˜ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
    }

    // ìˆ˜ì£¼ íƒ€ì…ë³„ íŠ¹ë³„ ê²€ì¦
    await this.validateByOrderType(request);

    // ìˆ˜ì£¼ í’ˆëª© ê²€ì¦
    if (!request.items || request.items.length === 0) {
      throw new Error("ìˆ˜ì£¼ í’ˆëª©ì€ ìµœì†Œ 1ê°œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
    }

    // ì œí’ˆ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    for (const item of request.items) {
      const productExists = await this.productService.exists(item.productId);
      if (!productExists) {
        throw new Error(`ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì œí’ˆì…ë‹ˆë‹¤: ${item.productCode}`);
      }
    }
  }

  private async validateByOrderType(
    request: CreateOrderRequest
  ): Promise<void> {
    switch (request.orderType) {
      case OrderType.EXPORT:
        // ìˆ˜ì¶œ ìˆ˜ì£¼ì˜ ê²½ìš° ì¶”ê°€ ê²€ì¦
        if (!request.customer.email || !request.customer.email.includes("@")) {
          throw new Error("ìˆ˜ì¶œ ìˆ˜ì£¼ëŠ” ê³ ê° ì´ë©”ì¼ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.");
        }
        break;

      case OrderType.SAMPLE:
        // ìƒ˜í”Œ ìˆ˜ì£¼ì˜ ê²½ìš° ìˆ˜ëŸ‰ ì œí•œ
        const totalQuantity = request.items.reduce(
          (sum, item) => sum + item.quantity,
          0
        );
        if (totalQuantity > 100) {
          throw new Error("ìƒ˜í”Œ ìˆ˜ì£¼ëŠ” ì´ ìˆ˜ëŸ‰ì´ 100ê°œë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }
        break;

      case OrderType.REPAIR:
        // ìˆ˜ë¦¬ ìˆ˜ì£¼ì˜ ê²½ìš° íŠ¹ë³„ ìŠ¹ì¸ í•„ìš”
        if (
          request.priority !== OrderPriority.HIGH &&
          request.priority !== OrderPriority.URGENT
        ) {
          throw new Error("ìˆ˜ë¦¬ ìˆ˜ì£¼ëŠ” ë†’ìŒ ì´ìƒì˜ ìš°ì„ ìˆœìœ„ê°€ í•„ìš”í•©ë‹ˆë‹¤.");
        }
        break;

      case OrderType.DOMESTIC:
      default:
        // ë‚´ìˆ˜ ìˆ˜ì£¼ëŠ” ê¸°ë³¸ ê²€ì¦ë§Œ
        break;
    }
  }

  private async createOrderItems(
    itemRequests: CreateOrderItemRequest[]
  ): Promise<OrderItem[]> {
    return itemRequests.map((itemRequest) => {
      const amount = itemRequest.quantity * itemRequest.unitPrice;

      return new OrderItem(
        this.generateOrderItemId(),
        itemRequest.productId,
        itemRequest.productCode,
        itemRequest.productName,
        itemRequest.quantity,
        itemRequest.unit,
        itemRequest.unitPrice,
        amount,
        itemRequest.deliveryDate,
        itemRequest.notes
      );
    });
  }

  private getOrderTypeDisplayName(orderType: OrderType): string {
    switch (orderType) {
      case OrderType.DOMESTIC:
        return "ë‚´ìˆ˜";
      case OrderType.EXPORT:
        return "ìˆ˜ì¶œ";
      case OrderType.SAMPLE:
        return "ìƒ˜í”Œ";
      case OrderType.REPAIR:
        return "ìˆ˜ë¦¬";
      default:
        return "ë‚´ìˆ˜";
    }
  }

  private generateOrderId(): string {
    return "ORD-" + Date.now().toString();
  }

  private generateOrderItemId(): string {
    return (
      "ITEM-" +
      Date.now().toString() +
      "-" +
      Math.random().toString(36).substr(2, 9)
    );
  }

  private generateHistoryId(): string {
    return "HIST-" + Date.now().toString();
  }
}
```

#### 2. ìˆ˜ì£¼ ìˆ˜ì • UseCase

```typescript
// application/usecases/order/UpdateOrderUseCase.ts
export interface UpdateOrderRequest {
  orderId: string;
  orderType?: OrderType;
  customer?: {
    code: string;
    name: string;
    contactPerson: string;
    phoneNumber: string;
    email: string;
    address: string;
  };
  deliveryDate?: Date;
  priority?: OrderPriority;
  notes?: string;
  salesPerson?: string;
  items?: UpdateOrderItemRequest[];
  id_updated: string; // ìˆ˜ì •ì ID
  reason?: string;
}

export interface UpdateOrderItemRequest {
  id?: string; // ê¸°ì¡´ í’ˆëª© ID (ìˆ˜ì • ì‹œ)
  productId: string;
  productCode: string;
  productName: string;
  quantity: number;
  unit: string;
  unitPrice: number;
  deliveryDate: Date;
  notes: string;
  isDeleted?: boolean; // ì‚­ì œ ì—¬ë¶€
}

export interface UpdateOrderResponse {
  success: boolean;
  message: string;
  updatedFields: string[];
}

export class UpdateOrderUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderHistoryRepository: OrderHistoryRepository,
    private productService: ProductService
  ) {}

  async execute(request: UpdateOrderRequest): Promise<UpdateOrderResponse> {
    // 1. ìˆ˜ì£¼ ì¡´ì¬ í™•ì¸
    const existingOrder = await this.orderRepository.findById(
      new OrderId(request.orderId)
    );
    if (!existingOrder) {
      throw new Error("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    // 2. ìˆ˜ì • ê°€ëŠ¥ì„± ê²€ì¦
    await this.validateUpdate(existingOrder, request);

    // 3. ë³€ê²½ ì‚¬í•­ ì¶”ì 
    const changedFields = await this.detectChanges(existingOrder, request);
    if (changedFields.length === 0) {
      throw new Error("ë³€ê²½ëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.");
    }

    // 4. ìˆ˜ì£¼ ì •ë³´ ì—…ë°ì´íŠ¸
    const updatedOrder = await this.createUpdatedOrder(existingOrder, request);

    // 5. ì €ì¥
    await this.orderRepository.save(updatedOrder);

    // 6. ì´ë ¥ ê¸°ë¡
    const history = new OrderHistory(
      this.generateHistoryId(),
      existingOrder.getId(),
      OrderHistoryAction.UPDATE,
      changedFields,
      request.id_updated,
      request.id_updated, // ìˆ˜ì •ìëª… (ì‹¤ì œë¡œëŠ” ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ í•„ìš”)
      new Date(),
      request.reason
    );
    await this.orderHistoryRepository.save(history);

    return {
      success: true,
      message: "ìˆ˜ì£¼ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
      updatedFields: changedFields.map((field) => field.fieldName),
    };
  }

  private async validateUpdate(
    existingOrder: Order,
    request: UpdateOrderRequest
  ): Promise<void> {
    // ìƒíƒœë³„ ìˆ˜ì • ì œí•œ
    if (existingOrder.getStatus() === OrderStatus.COMPLETED) {
      throw new Error("ì™„ë£Œëœ ìˆ˜ì£¼ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    if (existingOrder.getStatus() === OrderStatus.CANCELLED) {
      throw new Error("ì·¨ì†Œëœ ìˆ˜ì£¼ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    // ìƒì‚° ì¤‘ì¸ ìˆ˜ì£¼ì˜ ê²½ìš° ì œí•œì  ìˆ˜ì •ë§Œ í—ˆìš©
    if (existingOrder.getStatus() === OrderStatus.IN_PRODUCTION) {
      if (request.items || request.deliveryDate) {
        throw new Error(
          "ìƒì‚° ì¤‘ì¸ ìˆ˜ì£¼ëŠ” í’ˆëª© ì •ë³´ë‚˜ ë‚©ê¸°ì¼ì„ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
        );
      }
    }

    // ë‚©ê¸°ì¼ ê²€ì¦
    if (request.deliveryDate) {
      const today = new Date();
      if (request.deliveryDate <= today) {
        throw new Error("ë‚©ê¸°ì¼ì€ ì˜¤ëŠ˜ ë‚ ì§œë³´ë‹¤ ë‚˜ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
      }
    }

    // ì œí’ˆ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    if (request.items) {
      for (const item of request.items) {
        if (!item.isDeleted) {
          const productExists = await this.productService.exists(
            item.productId
          );
          if (!productExists) {
            throw new Error(`ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì œí’ˆì…ë‹ˆë‹¤: ${item.productCode}`);
          }
        }
      }
    }
  }

  private async detectChanges(
    existingOrder: Order,
    request: UpdateOrderRequest
  ): Promise<ChangedField[]> {
    const changes: ChangedField[] = [];

    // ìˆ˜ì£¼ íƒ€ì… ë³€ê²½
    if (
      request.orderType &&
      request.orderType !== existingOrder.getOrderType()
    ) {
      changes.push(
        new ChangedField(
          "orderType",
          existingOrder.getOrderType(),
          request.orderType
        )
      );
    }

    // ê³ ê° ì •ë³´ ë³€ê²½
    if (request.customer) {
      const existingCustomer = existingOrder.getCustomer();
      if (request.customer.code !== existingCustomer.code) {
        changes.push(
          new ChangedField(
            "customer.code",
            existingCustomer.code,
            request.customer.code
          )
        );
      }
      if (request.customer.name !== existingCustomer.name) {
        changes.push(
          new ChangedField(
            "customer.name",
            existingCustomer.name,
            request.customer.name
          )
        );
      }
      if (request.customer.contactPerson !== existingCustomer.contactPerson) {
        changes.push(
          new ChangedField(
            "customer.contactPerson",
            existingCustomer.contactPerson,
            request.customer.contactPerson
          )
        );
      }
    }

    // ë‚©ê¸°ì¼ ë³€ê²½
    if (
      request.deliveryDate &&
      request.deliveryDate.getTime() !==
        existingOrder.getDeliveryDate().getTime()
    ) {
      changes.push(
        new ChangedField(
          "deliveryDate",
          existingOrder.getDeliveryDate(),
          request.deliveryDate
        )
      );
    }

    // ìš°ì„ ìˆœìœ„ ë³€ê²½
    if (request.priority && request.priority !== existingOrder.getPriority()) {
      changes.push(
        new ChangedField(
          "priority",
          existingOrder.getPriority(),
          request.priority
        )
      );
    }

    // ì˜ì—…ë‹´ë‹¹ì ë³€ê²½
    if (
      request.salesPerson &&
      request.salesPerson !== existingOrder.getSalesPerson()
    ) {
      changes.push(
        new ChangedField(
          "salesPerson",
          existingOrder.getSalesPerson(),
          request.salesPerson
        )
      );
    }

    // ë¹„ê³  ë³€ê²½
    if (
      request.notes !== undefined &&
      request.notes !== existingOrder.getNotes()
    ) {
      changes.push(
        new ChangedField("notes", existingOrder.getNotes(), request.notes)
      );
    }

    // í’ˆëª© ë³€ê²½ (ë³µì¡í•œ ë¡œì§ì´ë¯€ë¡œ ë³„ë„ ë©”ì†Œë“œ)
    if (request.items) {
      const itemChanges = await this.detectItemChanges(
        existingOrder.getItems(),
        request.items
      );
      changes.push(...itemChanges);
    }

    return changes;
  }

  private async detectItemChanges(
    existingItems: OrderItem[],
    requestItems: UpdateOrderItemRequest[]
  ): Promise<ChangedField[]> {
    const changes: ChangedField[] = [];

    // ê¸°ì¡´ í’ˆëª©ê³¼ ìš”ì²­ í’ˆëª© ë¹„êµ
    const existingItemMap = new Map(
      existingItems.map((item) => [item.getId(), item])
    );
    const requestItemMap = new Map(
      requestItems.map((item) => [item.id || "new", item])
    );

    // ì‚­ì œëœ í’ˆëª© í™•ì¸
    for (const [itemId, existingItem] of existingItemMap) {
      const requestItem = requestItems.find((req) => req.id === itemId);
      if (!requestItem || requestItem.isDeleted) {
        changes.push(
          new ChangedField(
            "items",
            `ì‚­ì œ: ${existingItem.getProductCode()}`,
            null
          )
        );
      }
    }

    // ì¶”ê°€/ìˆ˜ì •ëœ í’ˆëª© í™•ì¸
    for (const requestItem of requestItems) {
      if (requestItem.isDeleted) continue;

      if (!requestItem.id || requestItem.id === "new") {
        // ìƒˆë¡œ ì¶”ê°€ëœ í’ˆëª©
        changes.push(
          new ChangedField("items", null, `ì¶”ê°€: ${requestItem.productCode}`)
        );
      } else {
        // ìˆ˜ì •ëœ í’ˆëª©
        const existingItem = existingItemMap.get(requestItem.id);
        if (existingItem) {
          if (existingItem.getQuantity() !== requestItem.quantity) {
            changes.push(
              new ChangedField(
                "items",
                `${existingItem.getProductCode()} ìˆ˜ëŸ‰: ${existingItem.getQuantity()}`,
                `${requestItem.productCode} ìˆ˜ëŸ‰: ${requestItem.quantity}`
              )
            );
          }
          if (existingItem.getUnitPrice() !== requestItem.unitPrice) {
            changes.push(
              new ChangedField(
                "items",
                `${existingItem.getProductCode()} ë‹¨ê°€: ${existingItem.getUnitPrice()}`,
                `${requestItem.productCode} ë‹¨ê°€: ${requestItem.unitPrice}`
              )
            );
          }
        }
      }
    }

    return changes;
  }

  private async createUpdatedOrder(
    existingOrder: Order,
    request: UpdateOrderRequest
  ): Promise<Order> {
    // ê³ ê° ì •ë³´ ì—…ë°ì´íŠ¸
    const customer = request.customer
      ? new Customer(
          request.customer.code,
          request.customer.name,
          request.customer.contactPerson,
          request.customer.phoneNumber,
          request.customer.email,
          request.customer.address
        )
      : existingOrder.getCustomer();

    // í’ˆëª© ì •ë³´ ì—…ë°ì´íŠ¸
    const updatedItems = request.items
      ? await this.createUpdatedItems(request.items)
      : existingOrder.getItems();

    // ì´ ê¸ˆì•¡ ì¬ê³„ì‚°
    const totalAmount = updatedItems.reduce(
      (total, item) => total + item.getAmount(),
      0
    );

    return new Order(
      existingOrder.getId(),
      existingOrder.getOrderNo(),
      request.orderType ?? existingOrder.getOrderType(),
      customer,
      existingOrder.getOrderDate(),
      request.deliveryDate ?? existingOrder.getDeliveryDate(),
      existingOrder.getStatus(),
      updatedItems,
      totalAmount,
      existingOrder.getCurrency(),
      request.priority ?? existingOrder.getPriority(),
      request.notes ?? existingOrder.getNotes(),
      request.salesPerson ?? existingOrder.getSalesPerson(),
      existingOrder.getIdCreate(),
      request.id_updated,
      existingOrder.getDtCreate(),
      new Date()
    );
  }

  private async createUpdatedItems(
    requestItems: UpdateOrderItemRequest[]
  ): Promise<OrderItem[]> {
    const updatedItems: OrderItem[] = [];

    for (const requestItem of requestItems) {
      if (requestItem.isDeleted) continue;

      const amount = requestItem.quantity * requestItem.unitPrice;
      const itemId = requestItem.id || this.generateOrderItemId();

      updatedItems.push(
        new OrderItem(
          itemId,
          requestItem.productId,
          requestItem.productCode,
          requestItem.productName,
          requestItem.quantity,
          requestItem.unit,
          requestItem.unitPrice,
          amount,
          requestItem.deliveryDate,
          requestItem.notes
        )
      );
    }

    return updatedItems;
  }

  private generateHistoryId(): string {
    return "HIST-" + Date.now().toString();
  }

  private generateOrderItemId(): string {
    return (
      "ITEM-" +
      Date.now().toString() +
      "-" +
      Math.random().toString(36).substr(2, 9)
    );
  }
}
```

#### 3. ìˆ˜ì£¼ ì‚­ì œ UseCase

```typescript
// application/usecases/order/DeleteOrderUseCase.ts
export interface DeleteOrderRequest {
  orderId: string;
  id_updated: string; // ì‚­ì œ ì²˜ë¦¬ì ID
  reason?: string;
}

export interface DeleteOrderResponse {
  success: boolean;
  message: string;
}

export class DeleteOrderUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderHistoryRepository: OrderHistoryRepository,
    private productionOrderService: ProductionOrderService
  ) {}

  async execute(request: DeleteOrderRequest): Promise<DeleteOrderResponse> {
    const order = await this.orderRepository.findById(
      new OrderId(request.orderId)
    );
    if (!order) {
      throw new Error("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    // ì‚­ì œ ê°€ëŠ¥ì„± ê²€ì¦
    await this.validateDeletion(order);

    // ê´€ë ¨ ìƒì‚° ì§€ì‹œ ì·¨ì†Œ ì²˜ë¦¬
    await this.cancelRelatedProductionOrders(order);

    // ìˆ˜ì£¼ ìƒíƒœë¥¼ ì·¨ì†Œë¡œ ë³€ê²½ (ë…¼ë¦¬ ì‚­ì œ)
    const deletedOrder = order.changeStatus(
      OrderStatus.CANCELLED,
      request.reason
    );
    await this.orderRepository.save(deletedOrder);

    // ì‚­ì œ ì´ë ¥ ê¸°ë¡
    const history = new OrderHistory(
      this.generateHistoryId(),
      order.getId(),
      OrderHistoryAction.DELETE,
      [new ChangedField("status", order.getStatus(), OrderStatus.CANCELLED)],
      request.id_updated,
      request.id_updated,
      new Date(),
      request.reason || "ìˆ˜ì£¼ ì‚­ì œ"
    );
    await this.orderHistoryRepository.save(history);

    return {
      success: true,
      message: "ìˆ˜ì£¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
    };
  }

  private async validateDeletion(order: Order): Promise<void> {
    if (order.getStatus() === OrderStatus.COMPLETED) {
      throw new Error("ì™„ë£Œëœ ìˆ˜ì£¼ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    if (order.getStatus() === OrderStatus.CANCELLED) {
      throw new Error("ì´ë¯¸ ì·¨ì†Œëœ ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    // ìƒì‚° ì§„í–‰ ìƒí™© í™•ì¸
    if (order.getStatus() === OrderStatus.IN_PRODUCTION) {
      const productionProgress =
        await this.productionOrderService.getProgressByOrderId(order.getId());
      if (productionProgress > 50) {
        // 50% ì´ìƒ ì§„í–‰ëœ ê²½ìš°
        throw new Error("ìƒì‚°ì´ 50% ì´ìƒ ì§„í–‰ëœ ìˆ˜ì£¼ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      }
    }
  }

  private async cancelRelatedProductionOrders(order: Order): Promise<void> {
    if (order.getStatus() === OrderStatus.IN_PRODUCTION) {
      await this.productionOrderService.cancelByOrderId(order.getId());
    }
  }

  private generateHistoryId(): string {
    return "HIST-" + Date.now().toString();
  }
}
```

#### 4. ìˆ˜ì£¼ ì´ë ¥ ì¡°íšŒ UseCase

```typescript
// application/usecases/order/GetOrderHistoryUseCase.ts
export interface GetOrderHistoryRequest {
  orderId: string;
  page?: number;
  pageSize?: number;
  actionFilter?: OrderHistoryAction[];
  startDate?: Date;
  endDate?: Date;
}

export interface GetOrderHistoryResponse {
  orderInfo: OrderBasicInfo;
  histories: OrderHistoryItem[];
  totalCount: number;
  currentPage: number;
  totalPages: number;
}

export interface OrderBasicInfo {
  orderId: string;
  orderNo: string;
  orderType: string;
  customerName: string;
  currentStatus: string;
  totalAmount: number;
  orderDate: Date;
  deliveryDate: Date;
}

export interface OrderHistoryItem {
  id: string;
  action: string;
  actionDisplay: string;
  changedFields: HistoryChangedField[];
  userId: string;
  userName: string;
  timestamp: Date;
  reason?: string;
  summary: string; // ë³€ê²½ ì‚¬í•­ ìš”ì•½
}

export interface HistoryChangedField {
  fieldName: string;
  fieldDisplayName: string;
  oldValue: any;
  newValue: any;
  oldValueDisplay: string;
  newValueDisplay: string;
}

export class GetOrderHistoryUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderHistoryRepository: OrderHistoryRepository,
    private orderPresenter: OrderPresenter
  ) {}

  async execute(request: GetOrderHistoryRequest): Promise<GetOrderHistoryResponse> {
    // 1. ìˆ˜ì£¼ ì •ë³´ ì¡°íšŒ
    const order = await this.orderRepository.findById(new OrderId(request.orderId));
    if (!order) {
      throw new Error('ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.');
    }

    // 2. ì´ë ¥ ì¡°íšŒ ì¡°ê±´ êµ¬ì„±
    const historyRequest = {
      orderId: order.getId(),
      page: request.page || 1,
      pageSize: request.pageSize || 20,
      actionFilter: request.actionFilter,
      startDate: request.startDate,
      endDate: request.endDate
    };

    // 3. ì´ë ¥ ëª©ë¡ ì¡°íšŒ
    const histories = await this.orderHistoryRepository.findByOrderIdWithPaging(historyRequest);
    const totalCount = await this.orderHistoryRepository.countByOrderId(order.getId(), historyRequest);

    // 4. ìˆ˜ì£¼ ê¸°ë³¸ ì •ë³´ êµ¬ì„±
    const orderInfo: OrderBasicInfo = {
      orderId: order.getId().getValue(),
      orderNo: order.getOrderNo(),
      orderType: this.orderPresenter.getOrderTypeDisplayName(order.getOrderType()),
      customerName: order.getCustomer().name,
      currentStatus: this.orderPresenter.getStatusDisplayName(order.getStatus()),
      totalAmount: order.getTotalAmount(),
      orderDate: order.getOrderDate(),
      deliveryDate: order.getDeliveryDate()
    };

    // 5. ì´ë ¥ í•­ëª© ë³€í™˜
    const historyItems = histories.map(history => this.convertToHistoryItem(history));

    // 6. í˜ì´ì§• ì •ë³´ ê³„ì‚°
    const totalPages = Math.ceil(totalCount / historyRequest.pageSize);

    return {
      orderInfo,
      histories: historyItems,
      totalCount,
      currentPage: historyRequest.page,
      totalPages
    };
  }

  private convertToHistoryItem(history: OrderHistory): OrderHistoryItem {
    const changedFields = history.getChangedFields().map(field => ({
      fieldName: field.fieldName,
      fieldDisplayName: this.getFieldDisplayName(field.fieldName),
      oldValue: field.oldValue,
      newValue: field.newValue,
      oldValueDisplay: this.formatFieldValue(field.fieldName, field.oldValue),
      newValueDisplay: this.formatFieldValue(field.fieldName, field.newValue)
    }));

    return {
      id: history.getId(),
      action: history.getAction(),
      actionDisplay: this.orderPresenter.getHistoryActionDisplayName(history.getAction()),
      changedFields,
      userId: history.getUserId(),
      userName: history.getUserName(),
      timestamp: history.getTimestamp(),
      reason: history.getReason(),
      summary: this.generateChangeSummary(history.getAction(), changedFields)
    };
  }

  private getFieldDisplayName(fieldName: string): string {
    const fieldDisplayNames: Record<string, string> = {
      'orderType': 'ìˆ˜ì£¼ íƒ€ì…',
      'customer.name': 'ê³ ê°ëª…',
      'customer.contactPerson': 'ë‹´ë‹¹ì',
      'deliveryDate': 'ë‚©ê¸°ì¼',
      'priority': 'ìš°ì„ ìˆœìœ„',
      'salesPerson': 'ì˜ì—…ë‹´ë‹¹ì',
      'notes': 'ë¹„ê³ ',
      'status': 'ìƒíƒœ',
      'items': 'ìˆ˜ì£¼ í’ˆëª©'
    };

    return fieldDisplayNames[fieldName] || fieldName;
  }

  private formatFieldValue(fieldName: string, value: any): string {
    if (value === null || value === undefined) {
      return '';
    }

    switch (fieldName) {
      case 'deliveryDate':
      case 'orderDate':
        return new Date(value).toLocaleDateString('ko-KR');

      case 'priority':
        return this.orderPresenter.getPriorityDisplayName(value);

      case 'status':
        return this.orderPresenter.getStatusDisplayName(value);

      case 'orderType':
        return this.orderPresenter.getOrderTypeDisplayName(value);

      default:
        return String(value);
    }
  }

  private generateChangeSummary(action: OrderHistoryAction, changedFields: HistoryChangedField[]): string {
    switch (action) {
      case OrderHistoryAction.CREATE:
        return 'ìˆ˜ì£¼ê°€ ì‹ ê·œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.';

      case OrderHistoryAction.UPDATE:
        if (changedFields.length === 1) {
          const field = changedFields[0];
          return `${field.fieldDisplayName}ì´(ê°€) "${field.oldValueDisplay}"ì—ì„œ "${field.newValueDisplay}"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`;
        } else {
          const fieldNames = changedFields.map(f => f.fieldDisplayName).join(', ');
          return `${fieldNames} ë“± ${changedFields.length}ê°œ í•­ëª©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`;
        }

      case OrderHistoryAction.DELETE:
        return 'ìˆ˜ì£¼ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.';

      case OrderHistoryAction.CANCEL:
        return 'ìˆ˜ì£¼ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.';

      case OrderHistoryAction.START_PRODUCTION:
        return 'ìƒì‚° ì§€ì‹œê°€ ìƒì„±ë˜ì–´ ìƒì‚°ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.';

      case OrderHistoryAction.COMPLETE:
        return 'ìˆ˜ì£¼ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';

      default:
        return 'ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.';
    }
  }
}ë¡œëŠ” ê° ì œí’ˆì˜ í‘œì¤€ ìƒì‚° ì‹œê°„ì„ ì¡°íšŒí•˜ì—¬ ê³„ì‚°
      return total + item.getQuantity() * 1; // ì„ì‹œë¡œ 1ì‹œê°„/ê°œë¡œ ê³„ì‚°
    }, 0);
  }

  private generateHistoryId(): string {
    return 'HIST-' + Date.now().toString();
  }
}
```

#### 4. ìˆ˜ì£¼ ì·¨ì†Œ UseCase

```typescript
// application/usecases/order/CancelOrderUseCase.ts
export interface CancelOrderRequest {
  orderId: string;
  id_updated: string; // ì·¨ì†Œ ì²˜ë¦¬ì ID
  reason: string; // ì·¨ì†Œ ì‚¬ìœ  (í•„ìˆ˜)
}

export class CancelOrderUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderHistoryRepository: OrderHistoryRepository,
    private productionOrderService: ProductionOrderService
  ) {}

  async execute(request: CancelOrderRequest): Promise<void> {
    const order = await this.orderRepository.findById(
      new OrderId(request.orderId)
    );
    if (!order) {
      throw new Error("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    // ì·¨ì†Œ ê°€ëŠ¥ì„± ê²€ì¦
    await this.validateCancellation(order);

    // ì·¨ì†Œ ì‚¬ìœ  í•„ìˆ˜ ì²´í¬
    if (!request.reason || request.reason.trim().length === 0) {
      throw new Error("ì·¨ì†Œ ì‚¬ìœ ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.");
    }

    // ìƒì‚° ì§€ì‹œ ì·¨ì†Œ ì²˜ë¦¬
    await this.cancelRelatedProductionOrders(order);

    // ìˆ˜ì£¼ ìƒíƒœ ë³€ê²½
    const cancelledOrder = order.changeStatus(
      OrderStatus.CANCELLED,
      request.reason
    );

    await this.orderRepository.save(cancelledOrder);

    // ì´ë ¥ ê¸°ë¡
    const history = new OrderHistory(
      this.generateHistoryId(),
      order.getId(),
      OrderHistoryAction.CANCEL,
      [new ChangedField("status", order.getStatus(), OrderStatus.CANCELLED)],
      request.id_updated,
      request.id_updated,
      new Date(),
      request.reason
    );
    await this.orderHistoryRepository.save(history);
  }

  private async validateCancellation(order: Order): Promise<void> {
    if (!order.canBeCancelled()) {
      throw new Error("ì·¨ì†Œí•  ìˆ˜ ì—†ëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    if (order.getStatus() === OrderStatus.COMPLETED) {
      throw new Error("ì™„ë£Œëœ ìˆ˜ì£¼ëŠ” ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    if (order.getStatus() === OrderStatus.CANCELLED) {
      throw new Error("ì´ë¯¸ ì·¨ì†Œëœ ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }
  }

  private async cancelRelatedProductionOrders(order: Order): Promise<void> {
    if (order.getStatus() === OrderStatus.IN_PRODUCTION) {
      await this.productionOrderService.cancelByOrderId(order.getId());
    }
  }

  private generateHistoryId(): string {
    return "HIST-" + Date.now().toString();
  }
}
```

#### 5. ìƒì‚° ì§€ì‹œ ìƒì„± UseCase

```typescript
// application/usecases/order/CreateProductionOrderUseCase.ts
export interface CreateProductionOrderRequest {
  orderId: string;
  plannedStartDate: Date;
  id_create: string; // ìƒì‚° ì§€ì‹œ ìƒì„±ì ID
}

export interface CreateProductionOrderResponse {
  productionOrderId: string;
  productionOrderNo: string;
  success: boolean;
  message: string;
}

export class CreateProductionOrderUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderHistoryRepository: OrderHistoryRepository,
    private productionOrderService: ProductionOrderService,
    private bomService: BOMService
  ) {}

  async execute(
    request: CreateProductionOrderRequest
  ): Promise<CreateProductionOrderResponse> {
    // 1. ìˆ˜ì£¼ ì¡´ì¬ í™•ì¸
    const order = await this.orderRepository.findById(
      new OrderId(request.orderId)
    );
    if (!order) {
      throw new Error("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    // 2. ìƒì‚° ì§€ì‹œ ìƒì„± ê°€ëŠ¥ì„± ê²€ì¦
    await this.validateProductionOrderCreation(order, request);

    // 3. BOM ê²€ì¦
    await this.validateBOM(order);

    // 4. ìƒì‚° ì§€ì‹œ ìƒì„±
    const productionOrderResult =
      await this.productionOrderService.createFromOrder(
        order,
        request.plannedStartDate,
        request.id_create
      );

    // 5. ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ìƒì‚°ì¤‘'ìœ¼ë¡œ ë³€ê²½
    const updatedOrder = order.changeStatus(OrderStatus.IN_PRODUCTION);
    await this.orderRepository.save(updatedOrder);

    // 6. ì´ë ¥ ê¸°ë¡
    const history = new OrderHistory(
      this.generateHistoryId(),
      order.getId(),
      OrderHistoryAction.START_PRODUCTION,
      [
        new ChangedField(
          "status",
          OrderStatus.PENDING,
          OrderStatus.IN_PRODUCTION
        ),
      ],
      request.id_create,
      request.id_create,
      new Date(),
      `ìƒì‚° ì§€ì‹œ ìƒì„± (${productionOrderResult.productionOrderNo})`
    );
    await this.orderHistoryRepository.save(history);

    return {
      productionOrderId: productionOrderResult.productionOrderId,
      productionOrderNo: productionOrderResult.productionOrderNo,
      success: true,
      message: "ìƒì‚° ì§€ì‹œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
    };
  }

  private async validateProductionOrderCreation(
    order: Order,
    request: CreateProductionOrderRequest
  ): Promise<void> {
    if (!order.canCreateProductionOrder()) {
      throw new Error("ìƒì‚° ì§€ì‹œë¥¼ ìƒì„±í•  ìˆ˜ ì—†ëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.");
    }

    if (order.getStatus() !== OrderStatus.PENDING) {
      throw new Error("ëŒ€ê¸° ìƒíƒœì˜ ìˆ˜ì£¼ë§Œ ìƒì‚° ì§€ì‹œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    }

    // ê³„íš ì‹œì‘ì¼ ê²€ì¦
    const today = new Date();
    if (request.plannedStartDate < today) {
      throw new Error("ê³„íš ì‹œì‘ì¼ì€ ì˜¤ëŠ˜ ë‚ ì§œ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.");
    }

    // ë‚©ê¸°ì¼ê³¼ì˜ ì—¬ìœ  ì‹œê°„ í™•ì¸
    const deliveryDate = order.getDeliveryDate();
    const requiredDays = this.calculateRequiredProductionDays(order);
    const availableDays = Math.ceil(
      (deliveryDate.getTime() - request.plannedStartDate.getTime()) /
        (1000 * 60 * 60 * 24)
    );

    if (availableDays < requiredDays) {
      throw new Error(
        `ë‚©ê¸°ì¼ê¹Œì§€ ìƒì‚° ì‹œê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. (í•„ìš”: ${requiredDays}ì¼, ê°€ëŠ¥: ${availableDays}ì¼)`
      );
    }
  }

  private async validateBOM(order: Order): Promise<void> {
    for (const item of order.getItems()) {
      const hasBOM = await this.bomService.existsByProductId(
        item.getProductId()
      );
      if (!hasBOM) {
        throw new Error(
          `ì œí’ˆ ${item.getProductCode()}ì˜ BOMì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`
        );
      }
    }
  }

  private calculateRequiredProductionDays(order: Order): number {
    // ì‹¤ì œë¡œëŠ” ê° ì œí’ˆì˜ ë¦¬ë“œíƒ€ì„ê³¼ ìˆ˜ëŸ‰ì„ ê³ ë ¤í•˜ì—¬ ê³„ì‚°
    return Math.ceil(order.getItems().length * 2); // ì„ì‹œë¡œ í’ˆëª©ë‹¹ 2ì¼ë¡œ ê³„ì‚°
  }

  private generateHistoryId(): string {
    return "HIST-" + Date.now().toString();
  }
}
```

---

## ğŸ—„ï¸ Repository Interface ì—…ë°ì´íŠ¸

````typescript
// domain/repositories/OrderRepository.ts
export interface OrderRepository {
  save(order: Order): Promise<void>;
  findById(id: OrderId): Promise<Order | null>;
  findByOrderNo(orderNo: string): Promise<Order | null>;
  findByPageWithCriteria(
    criteria: OrderSearchCriteria,
    page: number,
    pageSize: number
  ): Promise<Order[]>;
  findAllByCriteria(criteria: OrderSearchCriteria): Promise<Order[]>;
  countByCriteria(criteria: OrderSearchCriteria): Promise<number>;
  findByDateRange(startDate: Date, endDate: Date): Promise<Order[]>;
  getLastSequenceByPrefix(prefix: string): Promise<number>;
  findByCustomerCode(customerCode: string): Promise<Order[]>;
  findByStatus(status: OrderStatus): Promise<Order[]>;
  findDelayedOrders(): Promise<Order[]>;
  findUrgentOrders(): Promise<Order[]>;
  softDelete(id: OrderId): Promise<void>; // ë…¼ë¦¬ ì‚­ì œìš©
}

// domain/repositories/OrderHistoryRepository.ts
export interface OrderHistoryRepository {
  save(history: OrderHistory): Promise<void>;
  findByOrderId(orderId: OrderId): Promise<OrderHistory[]>;
  findByOrderIdWithPaging(request: {
    orderId: OrderId;
    page: number;
    pageSize: number;
    actionFilter?: OrderHistoryAction[];
    startDate?: Date;
    endDate?: Date;
  }): Promise<OrderHistory[]>;
  countByOrderId(orderId: OrderId, filters?: {
    actionFilter?: OrderHistoryAction[];
    startDate?: Date;
    endDate?: Date;
  }): Promise<number>;
  findByUserId(userId: string): Promise<OrderHistory[]>;
  findByDateRange(startDate: Date, endDate: Date): Promise<OrderHistory[]>;
  findByAction(action: OrderHistoryAction): Promise<OrderHistory[]>;
}
``` await this.productionOrderService.createFromOrder(
      order,
      request.plannedStartDate,
      request.id_create
    );

    // 5. ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ìƒì‚°ì¤‘'ìœ¼ë¡œ ë³€ê²½
    const updatedOrder = order.changeStatus(OrderStatus.IN_PRODUCTION);
    await this.orderRepository.save(updatedOrder);

    // 6. ì´ë ¥ ê¸°ë¡
    const history = new OrderHistory(
      this.generateHistoryId(),
      order.getId(),
      OrderHistoryAction.START_PRODUCTION,
      [new ChangedField('status', OrderStatus.APPROVED, OrderStatus.IN_PRODUCTION)],
      request.id_create,
      request.id_create,
      new Date(),
      `ìƒì‚° ì§€ì‹œ ìƒì„± (${productionOrderResult.productionOrderNo})`
    );
    await this.orderHistoryRepository.save(history);

    return {
      productionOrderId: productionOrderResult.productionOrderId,
      productionOrderNo: productionOrderResult.productionOrderNo,
      success: true,
      message: 'ìƒì‚° ì§€ì‹œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.'
    };
  }

  private async validateProductionOrderCreation(order: Order, request: CreateProductionOrderRequest): Promise<void> {
    if (!order.canCreateProductionOrder()) {
      throw new Error('ìƒì‚° ì§€ì‹œë¥¼ ìƒì„±í•  ìˆ˜ ì—†ëŠ” ìˆ˜ì£¼ì…ë‹ˆë‹¤.');
    }

    if (order.getStatus() !== OrderStatus.APPROVED) {
      throw new Error('ìŠ¹ì¸ëœ ìˆ˜ì£¼ë§Œ ìƒì‚° ì§€ì‹œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    }

    // ê³„íš ì‹œì‘ì¼ ê²€ì¦
    const today = new Date();
    if (request.plannedStartDate < today) {
      throw new Error('ê³„íš ì‹œì‘ì¼ì€ ì˜¤ëŠ˜ ë‚ ì§œ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.');
    }

    // ë‚©ê¸°ì¼ê³¼ì˜ ì—¬ìœ  ì‹œê°„ í™•ì¸
    const deliveryDate = order.getDeliveryDate();
    const requiredDays = this.calculateRequiredProductionDays(order);
    const availableDays = Math.ceil((deliveryDate.getTime() - request.plannedStartDate.getTime()) / (1000 * 60 * 60 * 24));

    if (availableDays < requiredDays) {
      throw new Error(`ë‚©ê¸°ì¼ê¹Œì§€ ìƒì‚° ì‹œê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. (í•„ìš”: ${requiredDays}ì¼, ê°€ëŠ¥: ${availableDays}ì¼)`);
    }
  }

  private async validateBOM(order: Order): Promise<void> {
    for (const item of order.getItems()) {
      const hasBOM = await this.bomService.existsByProductId(item.getProductId());
      if (!hasBOM) {
        throw new Error(`ì œí’ˆ ${item.getProductCode()}ì˜ BOMì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`);
      }
    }
  }

  private calculateRequiredProductionDays(order: Order): number {
    // ì‹¤ì œë¡œëŠ” ê° ì œí’ˆì˜ ë¦¬ë“œíƒ€ì„ê³¼ ìˆ˜ëŸ‰ì„ ê³ ë ¤í•˜ì—¬ ê³„ì‚°
    return Math.ceil(order.getItems().length * 2); // ì„ì‹œë¡œ í’ˆëª©ë‹¹ 2ì¼ë¡œ ê³„ì‚°
  }

  private generateHistoryId(): string {
    return 'HIST-' + Date.now().toString();
  }
}
````

#### 6. ìˆ˜ì£¼ í˜„í™© ëŒ€ì‹œë³´ë“œ UseCase

```typescript
// application/usecases/order/GetOrderDashboardUseCase.ts
export interface GetOrderDashboardRequest {
  startDate?: Date;
  endDate?: Date;
}

export interface OrderDashboardResponse {
  summary: OrderSummary;
  statusDistribution: OrderStatusDistribution[];
  priorityDistribution: OrderPriorityDistribution[];
  monthlyTrend: MonthlyOrderTrend[];
  urgentOrders: UrgentOrderItem[];
  delayedOrders: DelayedOrderItem[];
}

export interface OrderSummary {
  totalOrders: number;
  totalAmount: number;
  pendingOrders: number;
  approvedOrders: number;
  inProductionOrders: number;
  completedOrders: number;
  cancelledOrders: number;
  averageOrderValue: number;
}

export interface OrderStatusDistribution {
  status: string;
  statusDisplay: string;
  count: number;
  percentage: number;
}

export interface OrderPriorityDistribution {
  priority: string;
  priorityDisplay: string;
  count: number;
  percentage: number;
}

export interface MonthlyOrderTrend {
  month: string;
  orderCount: number;
  totalAmount: number;
}

export interface UrgentOrderItem {
  orderId: string;
  orderNo: string;
  customerName: string;
  deliveryDate: Date;
  daysUntilDelivery: number;
  totalAmount: number;
}

export interface DelayedOrderItem {
  orderId: string;
  orderNo: string;
  customerName: string;
  deliveryDate: Date;
  daysDelayed: number;
  status: string;
}

export class GetOrderDashboardUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private orderPresenter: OrderPresenter
  ) {}

  async execute(
    request: GetOrderDashboardRequest
  ): Promise<OrderDashboardResponse> {
    const dateRange = this.getDateRange(request);

    // 1. ì „ì²´ ìˆ˜ì£¼ ì¡°íšŒ
    const orders = await this.orderRepository.findByDateRange(
      dateRange.startDate,
      dateRange.endDate
    );

    // 2. ìš”ì•½ ì •ë³´ ê³„ì‚°
    const summary = this.calculateSummary(orders);

    // 3. ìƒíƒœë³„ ë¶„í¬
    const statusDistribution = this.calculateStatusDistribution(orders);

    // 4. ìš°ì„ ìˆœìœ„ë³„ ë¶„í¬
    const priorityDistribution = this.calculatePriorityDistribution(orders);

    // 5. ì›”ë³„ íŠ¸ë Œë“œ
    const monthlyTrend = this.calculateMonthlyTrend(orders);

    // 6. ê¸´ê¸‰ ìˆ˜ì£¼ ëª©ë¡
    const urgentOrders = this.getUrgentOrders(orders);

    // 7. ì§€ì—° ìˆ˜ì£¼ ëª©ë¡
    const delayedOrders = this.getDelayedOrders(orders);

    return {
      summary,
      statusDistribution,
      priorityDistribution,
      monthlyTrend,
      urgentOrders,
      delayedOrders,
    };
  }

  private getDateRange(request: GetOrderDashboardRequest): {
    startDate: Date;
    endDate: Date;
  } {
    const endDate = request.endDate || new Date();
    const startDate =
      request.startDate ||
      new Date(endDate.getFullYear(), endDate.getMonth() - 11, 1); // ìµœê·¼ 12ê°œì›”

    return { startDate, endDate };
  }

  private calculateSummary(orders: Order[]): OrderSummary {
    const totalOrders = orders.length;
    const totalAmount = orders.reduce(
      (sum, order) => sum + order.getTotalAmount(),
      0
    );

    const statusCounts = {
      pending: orders.filter((o) => o.getStatus() === OrderStatus.PENDING)
        .length,
      approved: orders.filter((o) => o.getStatus() === OrderStatus.APPROVED)
        .length,
      inProduction: orders.filter(
        (o) => o.getStatus() === OrderStatus.IN_PRODUCTION
      ).length,
      completed: orders.filter((o) => o.getStatus() === OrderStatus.COMPLETED)
        .length,
      cancelled: orders.filter((o) => o.getStatus() === OrderStatus.CANCELLED)
        .length,
    };

    return {
      totalOrders,
      totalAmount,
      pendingOrders: statusCounts.pending,
      approvedOrders: statusCounts.approved,
      inProductionOrders: statusCounts.inProduction,
      completedOrders: statusCounts.completed,
      cancelledOrders: statusCounts.cancelled,
      averageOrderValue: totalOrders > 0 ? totalAmount / totalOrders : 0,
    };
  }

  private calculateStatusDistribution(
    orders: Order[]
  ): OrderStatusDistribution[] {
    const statusCounts = new Map<OrderStatus, number>();

    orders.forEach((order) => {
      const status = order.getStatus();
      statusCounts.set(status, (statusCounts.get(status) || 0) + 1);
    });

    const totalOrders = orders.length;

    return Array.from(statusCounts.entries()).map(([status, count]) => ({
      status,
      statusDisplay: this.orderPresenter.getStatusDisplayName(status),
      count,
      percentage: totalOrders > 0 ? (count / totalOrders) * 100 : 0,
    }));
  }

  private calculatePriorityDistribution(
    orders: Order[]
  ): OrderPriorityDistribution[] {
    const priorityCounts = new Map<OrderPriority, number>();

    orders.forEach((order) => {
      const priority = order.getPriority();
      priorityCounts.set(priority, (priorityCounts.get(priority) || 0) + 1);
    });

    const totalOrders = orders.length;

    return Array.from(priorityCounts.entries()).map(([priority, count]) => ({
      priority,
      priorityDisplay: this.orderPresenter.getPriorityDisplayName(priority),
      count,
      percentage: totalOrders > 0 ? (count / totalOrders) * 100 : 0,
    }));
  }

  private calculateMonthlyTrend(orders: Order[]): MonthlyOrderTrend[] {
    const monthlyData = new Map<string, { count: number; amount: number }>();

    orders.forEach((order) => {
      const monthKey = order.getOrderDate().toISOString().substring(0, 7); // YYYY-MM
      const existing = monthlyData.get(monthKey) || { count: 0, amount: 0 };
      monthlyData.set(monthKey, {
        count: existing.count + 1,
        amount: existing.amount + order.getTotalAmount(),
      });
    });

    return Array.from(monthlyData.entries())
      .sort(([a], [b]) => a.localeCompare(b))
      .map(([month, data]) => ({
        month,
        orderCount: data.count,
        totalAmount: data.amount,
      }));
  }

  private getUrgentOrders(orders: Order[]): UrgentOrderItem[] {
    const today = new Date();

    return orders
      .filter(
        (order) =>
          order.getPriority() === OrderPriority.URGENT &&
          order.getStatus() !== OrderStatus.COMPLETED &&
          order.getStatus() !== OrderStatus.CANCELLED
      )
      .map((order) => {
        const daysUntilDelivery = Math.ceil(
          (order.getDeliveryDate().getTime() - today.getTime()) /
            (1000 * 60 * 60 * 24)
        );

        return {
          orderId: order.getId().getValue(),
          orderNo: order.getOrderNo(),
          customerName: order.getCustomer().name,
          deliveryDate: order.getDeliveryDate(),
          daysUntilDelivery,
          totalAmount: order.getTotalAmount(),
        };
      })
      .sort((a, b) => a.daysUntilDelivery - b.daysUntilDelivery)
      .slice(0, 10); // ìƒìœ„ 10ê±´
  }

  private getDelayedOrders(orders: Order[]): DelayedOrderItem[] {
    const today = new Date();

    return orders
      .filter((order) => order.isDelayed())
      .map((order) => {
        const daysDelayed = Math.ceil(
          (today.getTime() - order.getDeliveryDate().getTime()) /
            (1000 * 60 * 60 * 24)
        );

        return {
          orderId: order.getId().getValue(),
          orderNo: order.getOrderNo(),
          customerName: order.getCustomer().name,
          deliveryDate: order.getDeliveryDate(),
          daysDelayed,
          status: this.orderPresenter.getStatusDisplayName(order.getStatus()),
        };
      })
      .sort((a, b) => b.daysDelayed - a.daysDelayed)
      .slice(0, 10); // ìƒìœ„ 10ê±´
  }
}
```

#### 7. ìˆ˜ì£¼ ë°ì´í„° ë‚´ë³´ë‚´ê¸° UseCase

```typescript
// application/usecases/order/ExportOrderListUseCase.ts
export interface ExportOrderListRequest {
  format: "excel" | "csv";
  filters?: OrderFilter[];
  columns?: string[];
  includeItems?: boolean;
  includeHistory?: boolean;
  startDate?: Date;
  endDate?: Date;
}

export interface ExportOrderListResponse {
  downloadUrl: string;
  fileName: string;
  fileSize: number;
}

export class ExportOrderListUseCase {
  constructor(
    private orderRepository: OrderRepository,
    private fileExportService: FileExportService,
    private orderPresenter: OrderPresenter
  ) {}

  async execute(
    request: ExportOrderListRequest
  ): Promise<ExportOrderListResponse> {
    // 1. ë‚´ë³´ë‚¼ ìˆ˜ì£¼ ëª©ë¡ ì¡°íšŒ
    const searchCriteria = {
      filters: request.filters || [],
      startDate: request.startDate,
      endDate: request.endDate,
      sortBy: "orderDate",
      sortDirection: "desc" as const,
    };

    const orders = await this.orderRepository.findAllByCriteria(searchCriteria);

    // 2. ë‚´ë³´ë‚´ê¸° ë°ì´í„° êµ¬ì„±
    let exportData: any[] = [];

    if (request.includeItems) {
      // ìˆ˜ì£¼ë³„ í’ˆëª© ìƒì„¸ ë°ì´í„°
      exportData = this.createOrderItemsExportData(orders);
    } else {
      // ìˆ˜ì£¼ ìš”ì•½ ë°ì´í„°
      exportData = this.createOrderSummaryExportData(orders);
    }

    // 3. ì»¬ëŸ¼ í•„í„°ë§
    const filteredData = request.columns
      ? this.filterColumns(exportData, request.columns)
      : exportData;

    // 4. íŒŒì¼ ìƒì„±
    const fileName = `ìˆ˜ì£¼ì •ë³´_${new Date().toISOString().split("T")[0]}.${
      request.format
    }`;
    const fileResult = await this.fileExportService.createFile(
      filteredData,
      request.format,
      fileName
    );

    return {
      downloadUrl: fileResult.url,
      fileName: fileResult.name,
      fileSize: fileResult.size,
    };
  }

  private createOrderSummaryExportData(orders: Order[]): any[] {
    return orders.map((order) => ({
      ìˆ˜ì£¼ë²ˆí˜¸: order.getOrderNo(),
      ê³ ê°ëª…: order.getCustomer().name,
      ìˆ˜ì£¼ì¼: order.getOrderDate().toLocaleDateString("ko-KR"),
      ë‚©ê¸°ì¼: order.getDeliveryDate().toLocaleDateString("ko-KR"),
      ìƒíƒœ: this.orderPresenter.getStatusDisplayName(order.getStatus()),
      ìš°ì„ ìˆœìœ„: this.orderPresenter.getPriorityDisplayName(order.getPriority()),
      ì´ê¸ˆì•¡: order.getTotalAmount().toLocaleString(),
      í†µí™”: order.getCurrency().symbol,
      ì˜ì—…ë‹´ë‹¹ì: order.getSalesPerson(),
      í’ˆëª©ìˆ˜: order.getItems().length,
      ë¹„ê³ : order.getNotes(),
      ë“±ë¡ì¼: order.getDtCreate().toLocaleDateString("ko-KR"),
      ìˆ˜ì •ì¼: order.getDtUpdate().toLocaleDateString("ko-KR"),
    }));
  }

  private createOrderItemsExportData(orders: Order[]): any[] {
    const exportData: any[] = [];

    orders.forEach((order) => {
      order.getItems().forEach((item) => {
        exportData.push({
          ìˆ˜ì£¼ë²ˆí˜¸: order.getOrderNo(),
          ê³ ê°ëª…: order.getCustomer().name,
          ìˆ˜ì£¼ì¼: order.getOrderDate().toLocaleDateString("ko-KR"),
          ë‚©ê¸°ì¼: order.getDeliveryDate().toLocaleDateString("ko-KR"),
          ìƒíƒœ: this.orderPresenter.getStatusDisplayName(order.getStatus()),
          ìš°ì„ ìˆœìœ„: this.orderPresenter.getPriorityDisplayName(
            order.getPriority()
          ),
          ì œí’ˆì½”ë“œ: item.getProductCode(),
          ì œí’ˆëª…: item.getProductName(),
          ìˆ˜ëŸ‰: item.getQuantity(),
          ë‹¨ìœ„: item.getUnit(),
          ë‹¨ê°€: item.getUnitPrice().toLocaleString(),
          ê¸ˆì•¡: item.getAmount().toLocaleString(),
          í’ˆëª©ë‚©ê¸°ì¼: item.getDeliveryDate().toLocaleDateString("ko-KR"),
          í’ˆëª©ë¹„ê³ : item.getNotes(),
          ì˜ì—…ë‹´ë‹¹ì: order.getSalesPerson(),
        });
      });
    });

    return exportData;
  }

  private filterColumns(data: any[], columns: string[]): any[] {
    return data.map((row) => {
      const filteredRow: any = {};
      columns.forEach((column) => {
        if (row.hasOwnProperty(column)) {
          filteredRow[column] = row[column];
        }
      });
      return filteredRow;
    });
  }
}
```

---

## ğŸ¬ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 1: ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡

```
ì „ì œì¡°ê±´: ì‚¬ìš©ìê°€ ìˆ˜ì£¼ê´€ë¦¬ í™”ë©´ì— ì ‘ì†í•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ "ì‹ ê·œ ìˆ˜ì£¼ ë“±ë¡" ë²„íŠ¼ í´ë¦­
2. ìˆ˜ì£¼ ë“±ë¡ ëª¨ë‹¬/í˜ì´ì§€ê°€ ì—´ë¦¼
3. ê³ ê° ì •ë³´ ì…ë ¥:
   - ê³ ê°ì½”ë“œ: CUST001 (ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒ)
   - ê³ ê°ëª…: ì‚¼ì„±ì „ì (ìë™ ì…ë ¥)
   - ë‹´ë‹¹ì: ê¹€ë‹´ë‹¹ì
   - ì—°ë½ì²˜: 02-1234-5678
4. ìˆ˜ì£¼ ê¸°ë³¸ ì •ë³´ ì…ë ¥:
   - ë‚©ê¸°ì¼: 2024-12-31 ì„ íƒ
   - ìš°ì„ ìˆœìœ„: ë†’ìŒ ì„ íƒ
   - ì˜ì—…ë‹´ë‹¹ì: ì´ì˜ì—… ì„ íƒ
   - ë¹„ê³ : ì—°ë§ ë‚©í’ˆ ìš”ì²­
5. ìˆ˜ì£¼ í’ˆëª© ì¶”ê°€:
   - ì œí’ˆì½”ë“œ: FG2412001 ì„ íƒ
   - ì œí’ˆëª…: ê°¤ëŸ­ì‹œ ì¼€ì´ìŠ¤ (ìë™ ì…ë ¥)
   - ìˆ˜ëŸ‰: 1000
   - ë‹¨ê°€: 15000
   - ê¸ˆì•¡: 15,000,000 (ìë™ ê³„ì‚°)
6. "ì €ì¥" ë²„íŠ¼ í´ë¦­
7. ì‹œìŠ¤í…œì´ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦:
   - ìˆ˜ì£¼ë²ˆí˜¸ ìë™ ìƒì„±: SO20241201001
   - ë‚©ê¸°ì¼ ìœ íš¨ì„± í™•ì¸
   - ì œí’ˆ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
   - ì´ ê¸ˆì•¡ ê³„ì‚°: 15,000,000ì›
8. ê²€ì¦ ì„±ê³µ ì‹œ:
   - ìˆ˜ì£¼ ì •ë³´ ì €ì¥ (ìƒíƒœ: ëŒ€ê¸°)
   - ë“±ë¡ ì´ë ¥ ê¸°ë¡
   - "ìˆ˜ì£¼ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤ (ìˆ˜ì£¼ë²ˆí˜¸: SO20241201001)" ë©”ì‹œì§€ í‘œì‹œ
   - ìˆ˜ì£¼ ëª©ë¡ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ë©° ìƒˆ ìˆ˜ì£¼ê°€ ëª©ë¡ì— ì¶”ê°€ë¨

í›„ì†ì¡°ê±´: ìƒˆë¡œìš´ ìˆ˜ì£¼ê°€ ì‹œìŠ¤í…œì— ë“±ë¡ë˜ê³  ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœê°€ ë¨
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 2: ìˆ˜ì£¼ ìŠ¹ì¸ ì²˜ë¦¬

```
ì „ì œì¡°ê±´: ìŠ¹ì¸ ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìê°€ ëŒ€ê¸° ìƒíƒœì˜ ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ì—ì„œ ìƒíƒœê°€ 'ëŒ€ê¸°'ì¸ ìˆ˜ì£¼ì˜ "ìŠ¹ì¸" ë²„íŠ¼ í´ë¦­
2. ìŠ¹ì¸ í™•ì¸ ëŒ€í™”ìƒì í‘œì‹œ:
   - "ìˆ˜ì£¼ 'SO20241201001 - ì‚¼ì„±ì „ì'ë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
   - ìŠ¹ì¸ ì‚¬ìœ  ì…ë ¥ í•„ë“œ (ì„ íƒì‚¬í•­)
3. ìŠ¹ì¸ ì‚¬ìœ  ì…ë ¥: "ê³ ê° ì‹ ë¢°ë„ ìš°ìˆ˜, ë‚©ê¸° ì¤€ìˆ˜ ê°€ëŠ¥"
4. "ìŠ¹ì¸" ë²„íŠ¼ í´ë¦­
5. ì‹œìŠ¤í…œì´ ìŠ¹ì¸ ê°€ëŠ¥ì„± ê²€ì¦:
   - í˜„ì¬ ìƒíƒœê°€ 'ëŒ€ê¸°'ì¸ì§€ í™•ì¸
   - ëª¨ë“  ìˆ˜ì£¼ í’ˆëª©ì´ ìœ íš¨í•œì§€ í™•ì¸
   - ë‚©ê¸°ì¼ì˜ ìƒì‚° ìš©ëŸ‰ í™•ì¸
6. ê²€ì¦ ì„±ê³µ ì‹œ:
   - ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ìŠ¹ì¸'ìœ¼ë¡œ ë³€ê²½
   - ìŠ¹ì¸ ì´ë ¥ ê¸°ë¡ (ìŠ¹ì¸ì, ì‹œê°„, ì‚¬ìœ )
   - "ìˆ˜ì£¼ê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤" ë©”ì‹œì§€ í‘œì‹œ
   - ëª©ë¡ì—ì„œ ìƒíƒœê°€ 'ìŠ¹ì¸'ìœ¼ë¡œ ë³€ê²½ë¨
   - "ìƒì‚°ì§€ì‹œ ìƒì„±" ë²„íŠ¼ì´ í™œì„±í™”ë¨
7. ê²€ì¦ ì‹¤íŒ¨ ì‹œ:
   - "ë‚©ê¸°ì¼ì— ìƒì‚° ìš©ëŸ‰ì´ ë¶€ì¡±í•©ë‹ˆë‹¤" ë“±ì˜ êµ¬ì²´ì  ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ

í›„ì†ì¡°ê±´: ìˆ˜ì£¼ê°€ ìŠ¹ì¸ ìƒíƒœê°€ ë˜ì–´ ìƒì‚° ì§€ì‹œ ìƒì„±ì´ ê°€ëŠ¥í•´ì§
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 3: ìƒì‚° ì§€ì‹œ ìƒì„±

```
ì „ì œì¡°ê±´: ìŠ¹ì¸ëœ ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìŠ¹ì¸ëœ ìˆ˜ì£¼ì˜ "ìƒì‚°ì§€ì‹œ ìƒì„±" ë²„íŠ¼ í´ë¦­
2. ìƒì‚° ì§€ì‹œ ìƒì„± ëª¨ë‹¬ì´ ì—´ë¦¼:
   - ìˆ˜ì£¼ ì •ë³´ í‘œì‹œ (ì½ê¸° ì „ìš©)
   - ê³„íš ì‹œì‘ì¼ ì…ë ¥ í•„ë“œ
   - ì˜ˆìƒ ì™„ë£Œì¼ í‘œì‹œ (ìë™ ê³„ì‚°)
3. ê³„íš ì‹œì‘ì¼ ì…ë ¥: 2024-12-15 ì„ íƒ
4. ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ì˜ˆìƒ ì™„ë£Œì¼ ê³„ì‚°: 2024-12-25 (10ì¼ ì†Œìš” ì˜ˆìƒ)
5. "ìƒì‚°ì§€ì‹œ ìƒì„±" ë²„íŠ¼ í´ë¦­
6. ì‹œìŠ¤í…œì´ ê²€ì¦:
   - ëª¨ë“  ìˆ˜ì£¼ í’ˆëª©ì˜ BOM ì¡´ì¬ ì—¬ë¶€ í™•ì¸
   - ê³„íš ì‹œì‘ì¼ê³¼ ë‚©ê¸°ì¼ ê°„ì˜ ì—¬ìœ  ì‹œê°„ í™•ì¸
   - í•„ìš” ìì¬ì˜ ì¬ê³  í™•ì¸ (ê²½ê³ ì„± ë©”ì‹œì§€)
7. ê²€ì¦ ì„±ê³µ ì‹œ:
   - ìƒì‚° ì§€ì‹œë²ˆí˜¸ ìë™ ìƒì„±: PO20241201001
   - ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ìƒì‚°ì¤‘'ìœ¼ë¡œ ë³€ê²½
   - ìƒì‚° ì§€ì‹œ ì´ë ¥ ê¸°ë¡
   - "ìƒì‚° ì§€ì‹œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤ (ìƒì‚°ì§€ì‹œë²ˆí˜¸: PO20241201001)" ë©”ì‹œì§€ í‘œì‹œ
   - ìƒì‚°ê´€ë¦¬ ì‹œìŠ¤í…œìœ¼ë¡œ ë°ì´í„° ì „ì†¡
8. ìì¬ ë¶€ì¡± ê²½ê³  ì‹œ:
   - "ì¼ë¶€ ìì¬ì˜ ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" í™•ì¸ ë©”ì‹œì§€
   - ì‚¬ìš©ì ì„ íƒì— ë”°ë¼ ì§„í–‰ ë˜ëŠ” ì·¨ì†Œ

í›„ì†ì¡°ê±´: ìƒì‚° ì§€ì‹œê°€ ìƒì„±ë˜ì–´ ìƒì‚°ê´€ë¦¬ ì‹œìŠ¤í…œì—ì„œ ì²˜ë¦¬ ì‹œì‘
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 4: ìˆ˜ì£¼ í˜„í™© ëŒ€ì‹œë³´ë“œ ì¡°íšŒ

```
ì „ì œì¡°ê±´: ê´€ë¦¬ìê°€ ìˆ˜ì£¼ê´€ë¦¬ ë©”ì¸ í™”ë©´ì— ì ‘ì†í•œ ìƒíƒœ

1. í˜ì´ì§€ ë¡œë”© ì‹œ ìë™ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œ ë°ì´í„° í‘œì‹œ
2. ìš”ì•½ ì •ë³´ ì¹´ë“œ í‘œì‹œ:
   - ì´ ìˆ˜ì£¼: 156ê±´
   - ì´ ê¸ˆì•¡: 2,450,000,000ì›
   - ëŒ€ê¸°: 12ê±´, ìŠ¹ì¸: 25ê±´, ìƒì‚°ì¤‘: 89ê±´, ì™„ë£Œ: 28ê±´, ì·¨ì†Œ: 2ê±´
   - í‰ê·  ìˆ˜ì£¼ ê¸ˆì•¡: 15,705,128ì›
3. ìƒíƒœë³„ ë¶„í¬ ì°¨íŠ¸:
   - íŒŒì´ ì°¨íŠ¸ë¡œ ê° ìƒíƒœë³„ ë¹„ìœ¨ í‘œì‹œ
   - ìƒì‚°ì¤‘ 57%, ìŠ¹ì¸ 16%, ì™„ë£Œ 18% ë“±
4. ìš°ì„ ìˆœìœ„ë³„ ë¶„í¬:
   - ê¸´ê¸‰ 5%, ë†’ìŒ 20%, ë³´í†µ 65%, ë‚®ìŒ 10%
5. ì›”ë³„ ìˆ˜ì£¼ íŠ¸ë Œë“œ ê·¸ë˜í”„:
   - ìµœê·¼ 12ê°œì›” ìˆ˜ì£¼ ê±´ìˆ˜ ë° ê¸ˆì•¡ ì¶”ì´
   - ë¼ì¸ ì°¨íŠ¸ë¡œ ì‹œê°í™”
6. ê¸´ê¸‰ ìˆ˜ì£¼ ëª©ë¡ (ìƒìœ„ 10ê±´):
   - ë‚©ê¸°ì¼ì´ ì„ë°•í•œ ê¸´ê¸‰ ìˆ˜ì£¼ë“¤ì„ í…Œì´ë¸”ë¡œ í‘œì‹œ
   - D-3, D-1 ë“±ìœ¼ë¡œ ë‚¨ì€ ì¼ìˆ˜ í‘œì‹œ
7. ì§€ì—° ìˆ˜ì£¼ ëª©ë¡ (ìƒìœ„ 10ê±´):
   - ë‚©ê¸°ì¼ì´ ì§€ë‚¬ì§€ë§Œ ë¯¸ì™„ë£Œëœ ìˆ˜ì£¼ë“¤
   - ì§€ì—° ì¼ìˆ˜ì™€ í•¨ê»˜ í‘œì‹œ
8. ì‚¬ìš©ìê°€ "ìƒì„¸ë³´ê¸°" í´ë¦­ ì‹œ í•´ë‹¹ ìˆ˜ì£¼ì˜ ìƒì„¸ í™”ë©´ìœ¼ë¡œ ì´ë™

í›„ì†ì¡°ê±´: ìˆ˜ì£¼ í˜„í™©ì„ í•œëˆˆì— íŒŒì•…í•˜ê³  ê¸´ê¸‰ ëŒ€ì‘ì´ í•„ìš”í•œ í•­ëª©ë“¤ì„ í™•ì¸í•¨
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 5: ìˆ˜ì£¼ ê²€ìƒ‰ ë° í•„í„°ë§

```
ì „ì œì¡°ê±´: ìˆ˜ì£¼ ëª©ë¡ í™”ë©´ì— ì ‘ì†í•œ ìƒíƒœ

1. í†µí•© ê²€ìƒ‰ ì‚¬ìš©:
   - ê²€ìƒ‰ì°½ì— "ì‚¼ì„±" ì…ë ¥ í›„ ì—”í„°
   - ìˆ˜ì£¼ë²ˆí˜¸, ê³ ê°ëª…, ì œí’ˆëª… ë“± ëª¨ë“  í•„ë“œì—ì„œ "ì‚¼ì„±" ê²€ìƒ‰
   - ê²°ê³¼: 8ê±´ì˜ ìˆ˜ì£¼ê°€ ê²€ìƒ‰ë¨
2. ìƒíƒœ í•„í„° ì ìš©:
   - ìƒíƒœ ë“œë¡­ë‹¤ìš´ì—ì„œ "ìŠ¹ì¸" ì„ íƒ
   - ìŠ¹ì¸ ìƒíƒœì¸ ìˆ˜ì£¼ë§Œ í•„í„°ë§
   - ê²°ê³¼: 3ê±´ìœ¼ë¡œ ì¶•ì†Œë¨
3. ë‚ ì§œ ë²”ìœ„ í•„í„°:
   - ìˆ˜ì£¼ì¼ ë²”ìœ„: 2024-11-01 ~ 2024-11-30
   - í•´ë‹¹ ê¸°ê°„ì˜ ìˆ˜ì£¼ë§Œ í‘œì‹œ
4. ìš°ì„ ìˆœìœ„ í•„í„°:
   - "ë†’ìŒ" ì²´í¬ë°•ìŠ¤ ì„ íƒ
   - ë†’ì€ ìš°ì„ ìˆœìœ„ ìˆ˜ì£¼ë§Œ í‘œì‹œ
5. ê³ ê°ë³„ í•„í„°:
   - ê³ ê° ë‹¤ì¤‘ì„ íƒ ë“œë¡­ë‹¤ìš´ì—ì„œ "ì‚¼ì„±ì „ì", "LGì „ì" ì„ íƒ
   - í•´ë‹¹ ê³ ê°ë“¤ì˜ ìˆ˜ì£¼ë§Œ í‘œì‹œ
6. ê¸ˆì•¡ ë²”ìœ„ í•„í„°:
   - ìµœì†Œ ê¸ˆì•¡: 10,000,000ì›
   - ìµœëŒ€ ê¸ˆì•¡: 50,000,000ì›
   - í•´ë‹¹ ê¸ˆì•¡ ë²”ìœ„ì˜ ìˆ˜ì£¼ë§Œ í‘œì‹œ
7. í•„í„° ì´ˆê¸°í™”:
   - "í•„í„° ì´ˆê¸°í™”" ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ ëª¨ë“  í•„í„° í•´ì œ
   - ì „ì²´ ìˆ˜ì£¼ ëª©ë¡ìœ¼ë¡œ ë³µì›

í›„ì†ì¡°ê±´: ì›í•˜ëŠ” ì¡°ê±´ì˜ ìˆ˜ì£¼ë“¤ë§Œ í‘œì‹œë˜ì–´ íš¨ìœ¨ì ì¸ ì—…ë¬´ ì²˜ë¦¬ ê°€ëŠ¥
```

### ğŸ‘¤ ì‹œë‚˜ë¦¬ì˜¤ 6: ìˆ˜ì£¼ ì·¨ì†Œ ì²˜ë¦¬

```
ì „ì œì¡°ê±´: ì·¨ì†Œí•  ìˆ˜ì£¼ë¥¼ ì„ íƒí•œ ìƒíƒœ

1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ì—ì„œ "ì·¨ì†Œ" ë²„íŠ¼ í´ë¦­
2. ì·¨ì†Œ í™•ì¸ ëŒ€í™”ìƒì í‘œì‹œ:
   - "ìˆ˜ì£¼ 'SO20241201001 - ì‚¼ì„±ì „ì'ë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
   - ì·¨ì†Œ ì‚¬ìœ  ì…ë ¥ í•„ë“œ (í•„ìˆ˜)
3. ì·¨ì†Œ ì‚¬ìœ  ì…ë ¥: "ê³ ê° ìš”ì²­ì— ì˜í•œ ì£¼ë¬¸ ì·¨ì†Œ"
4. "í™•ì¸" ë²„íŠ¼ í´ë¦­
5. ì‹œìŠ¤í…œì´ ì·¨ì†Œ ê°€ëŠ¥ì„± ê²€ì‚¬:
   - í˜„ì¬ ìƒíƒœê°€ ì·¨ì†Œ ê°€ëŠ¥í•œì§€ í™•ì¸ (ëŒ€ê¸°, ìŠ¹ì¸ë§Œ ê°€ëŠ¥)
   - ìƒì‚° ì§€ì‹œê°€ ì´ë¯¸ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
6. ì·¨ì†Œ ê°€ëŠ¥í•œ ê²½ìš°:
   - ê´€ë ¨ ìƒì‚° ì§€ì‹œê°€ ìˆë‹¤ë©´ í•¨ê»˜ ì·¨ì†Œ ì²˜ë¦¬
   - ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ì·¨ì†Œ'ë¡œ ë³€ê²½
   - ì·¨ì†Œ ì´ë ¥ ê¸°ë¡ (ì·¨ì†Œì, ì‹œê°„, ì‚¬ìœ )
   - "ìˆ˜ì£¼ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤" ë©”ì‹œì§€ í‘œì‹œ
   - ëª©ë¡ì—ì„œ ìƒíƒœê°€ 'ì·¨ì†Œ'ë¡œ í‘œì‹œë˜ë©° íšŒìƒ‰ìœ¼ë¡œ ë¹„í™œì„±í™”
7. ì·¨ì†Œ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°:
   - "ìƒì‚°ì´ ì§„í–‰ ì¤‘ì¸ ìˆ˜ì£¼ëŠ” ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ

í›„ì†ì¡°ê±´: ìˆ˜ì£¼ê°€ ì·¨ì†Œ ìƒíƒœê°€ ë˜ì–´ ë” ì´ìƒ ì²˜ë¦¬ë˜ì§€ ì•ŠìŒ
```

---

## ğŸ¯ Use Cases ìƒì„¸ ì •ì˜ (ì—…ë°ì´íŠ¸)

### 1. ìˆ˜ì£¼ ëª©ë¡ ì¡°íšŒ UseCase

```typescript
ğŸ“‹ UseCase: GetOrderListUseCase
ğŸ“ ì„¤ëª…: í˜ì´ì§•, ì •ë ¬, í•„í„°ë§, ê²€ìƒ‰ì´ ì ìš©ëœ ìˆ˜ì£¼ ëª©ë¡ì„ ì¡°íšŒí•œë‹¤.

ğŸ¯ ì£¼ìš” ì•¡í„°: ì˜ì—…ë‹´ë‹¹ì, ìƒì‚°ê³„íšì, ê´€ë¦¬ì
ğŸ“¥ ì…ë ¥: í˜ì´ì§€ ì •ë³´, ì •ë ¬ ì¡°ê±´, í•„í„° ì¡°ê±´, ê²€ìƒ‰ í‚¤ì›Œë“œ
ğŸ“¤ ì¶œë ¥: ìˆ˜ì£¼ ëª©ë¡, í˜ì´ì§• ì •ë³´, ì´ ê°œìˆ˜

âœ… ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤:
1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ëª©ë¡ ì¡°íšŒ ìš”ì²­
2. ì‹œìŠ¤í…œì´ ì…ë ¥ ì¡°ê±´ ê²€ì¦
3. ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°ê±´ì— ë§ëŠ” ìˆ˜ì£¼ ì¡°íšŒ
4. ë‚©ê¸°ì¼ê¹Œì§€ ë‚¨ì€ ì¼ìˆ˜ ê³„ì‚°
5. ì§€ì—° ì—¬ë¶€ íŒë‹¨
6. í˜ì´ì§• ì •ë³´ ê³„ì‚°
7. ê²°ê³¼ ë°˜í™˜

âŒ ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤:
- ì˜ëª»ëœ í˜ì´ì§€ ë²ˆí˜¸ ì…ë ¥ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜ ì‹œ ì¬ì‹œë„ ì•ˆë‚´
- ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ì ì ‘ê·¼ ì‹œ ì ‘ê·¼ ê±°ë¶€

ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™:
- í˜ì´ì§€ í¬ê¸°ëŠ” 1-1000 ë²”ìœ„
- ì·¨ì†Œëœ ìˆ˜ì£¼ë„ ì¡°íšŒ ê°€ëŠ¥ (ë³„ë„ í‘œì‹œ)
- ì§€ì—°ëœ ìˆ˜ì£¼ëŠ” ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸
- ê¸´ê¸‰ ìˆ˜ì£¼ëŠ” ë³„ë„ ì•„ì´ì½˜ í‘œì‹œ
```

### 2. ìˆ˜ì£¼ ë“±ë¡ UseCase

```typescript
ğŸ“‹ UseCase: CreateOrderUseCase
ğŸ“ ì„¤ëª…: ìƒˆë¡œìš´ ìˆ˜ì£¼ ì •ë³´ë¥¼ ì‹œìŠ¤í…œì— ë“±ë¡í•œë‹¤.

ğŸ¯ ì£¼ìš” ì•¡í„°: ì˜ì—…ë‹´ë‹¹ì
ğŸ“¥ ì…ë ¥: ê³ ê° ì •ë³´, ìˆ˜ì£¼ í’ˆëª© ì •ë³´, ë‚©ê¸°ì¼, ìš°ì„ ìˆœìœ„ ë“±
ğŸ“¤ ì¶œë ¥: ë“±ë¡ ì„±ê³µ ì—¬ë¶€, ìƒì„±ëœ ìˆ˜ì£¼ë²ˆí˜¸

âœ… ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤:
1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ë“±ë¡ ì •ë³´ ì…ë ¥
2. ì‹œìŠ¤í…œì´ ì…ë ¥ ë°ì´í„° ê²€ì¦
3. ìˆ˜ì£¼ë²ˆí˜¸ ìë™ ì±„ë²ˆ
4. ê³ ê° ì •ë³´ ìœ íš¨ì„± í™•ì¸
5. ì œí’ˆ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
6. ì´ ê¸ˆì•¡ ìë™ ê³„ì‚°
7. ìˆ˜ì£¼ ì—”í‹°í‹° ìƒì„± ë° ì €ì¥
8. ë“±ë¡ ì´ë ¥ ê¸°ë¡
9. ì„±ê³µ ì‘ë‹µ ë°˜í™˜

âŒ ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤:
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê³ ê° ì½”ë“œ
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì œí’ˆ ì½”ë“œ
- ì˜ëª»ëœ ë‚©ê¸°ì¼ (ê³¼ê±° ë‚ ì§œ)
- ìˆ˜ëŸ‰ì´ë‚˜ ë‹¨ê°€ê°€ 0 ì´í•˜

ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™:
- ìˆ˜ì£¼ë²ˆí˜¸ëŠ” ì‹œìŠ¤í…œ ë‚´ ìœ ì¼í•´ì•¼ í•¨
- ë‚©ê¸°ì¼ì€ ìˆ˜ì£¼ì¼ë³´ë‹¤ ë‚˜ì¤‘ì´ì–´ì•¼ í•¨
- ìˆ˜ì£¼ í’ˆëª©ì€ ìµœì†Œ 1ê°œ ì´ìƒ
- ë“±ë¡ ì¦‰ì‹œ ì´ë ¥ ê¸°ë¡ ìƒì„±
- ì´ˆê¸° ìƒíƒœëŠ” 'ëŒ€ê¸°'
- ë“±ë¡ í›„ ë°”ë¡œ ìƒì‚° ì§€ì‹œ ìƒì„± ê°€ëŠ¥
```

### 3. ìˆ˜ì£¼ ìˆ˜ì • UseCase

```typescript
ğŸ“‹ UseCase: UpdateOrderUseCase
ğŸ“ ì„¤ëª…: ê¸°ì¡´ ìˆ˜ì£¼ ì •ë³´ë¥¼ ìˆ˜ì •í•˜ê³  ë³€ê²½ ì´ë ¥ì„ ê´€ë¦¬í•œë‹¤.

ğŸ¯ ì£¼ìš” ì•¡í„°: ì˜ì—…ë‹´ë‹¹ì, ê´€ë¦¬ì
ğŸ“¥ ì…ë ¥: ìˆ˜ì£¼ ID, ìˆ˜ì •í•  ì •ë³´, ìˆ˜ì • ì‚¬ìœ 
ğŸ“¤ ì¶œë ¥: ìˆ˜ì • ì„±ê³µ ì—¬ë¶€, ë³€ê²½ëœ í•„ë“œ ëª©ë¡

âœ… ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤:
1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ìˆ˜ì • ì •ë³´ ì…ë ¥
2. ì‹œìŠ¤í…œì´ ê¸°ì¡´ ìˆ˜ì£¼ ì •ë³´ ì¡°íšŒ
3. ìƒíƒœë³„ ìˆ˜ì • ê¶Œí•œ í™•ì¸
4. ë³€ê²½ì‚¬í•­ ê²€ì¦ ë° ì¶”ì 
5. ìˆ˜ì£¼ ì •ë³´ ì—…ë°ì´íŠ¸
6. ë³€ê²½ ì´ë ¥ ê¸°ë¡
7. ì„±ê³µ ì‘ë‹µ ë°˜í™˜

âŒ ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤:
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ ID
- ì™„ë£Œ/ì·¨ì†Œëœ ìˆ˜ì£¼ ìˆ˜ì • ì‹œë„
- ìƒì‚°ì¤‘ ìˆ˜ì£¼ì˜ ì œí•œëœ í•„ë“œ ìˆ˜ì • ì‹œë„
- ë³€ê²½ì‚¬í•­ì´ ì—†ëŠ” ê²½ìš°

ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™:
- ì™„ë£Œ/ì·¨ì†Œëœ ìˆ˜ì£¼ëŠ” ìˆ˜ì • ë¶ˆê°€
- ìƒì‚°ì¤‘ ìˆ˜ì£¼ëŠ” í’ˆëª©/ë‚©ê¸°ì¼ ìˆ˜ì • ë¶ˆê°€
- ëª¨ë“  ë³€ê²½ì‚¬í•­ ì´ë ¥ ê¸°ë¡ í•„ìˆ˜
- ë³€ê²½ ì‚¬ìœ  ì…ë ¥ ê¶Œì¥
- í’ˆëª© ì¶”ê°€/ì‚­ì œ/ìˆ˜ì • ëª¨ë‘ ì¶”ì 
```

### 4. ìˆ˜ì£¼ ì‚­ì œ UseCase

```typescript
ğŸ“‹ UseCase: DeleteOrderUseCase
ğŸ“ ì„¤ëª…: ìˆ˜ì£¼ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ì‚­ì œí•˜ê³  ê´€ë ¨ ìƒì‚° ì§€ì‹œë„ í•¨ê»˜ ì·¨ì†Œí•œë‹¤.

ğŸ¯ ì£¼ìš” ì•¡í„°: ì˜ì—…ë‹´ë‹¹ì, ê´€ë¦¬ì
ğŸ“¥ ì…ë ¥: ìˆ˜ì£¼ ID, ì‚­ì œ ì‚¬ìœ 
ğŸ“¤ ì¶œë ¥: ì‚­ì œ ì„±ê³µ ì—¬ë¶€

âœ… ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤:
1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ì‚­ì œ ìš”ì²­
2. ì‹œìŠ¤í…œì´ ì‚­ì œ ê°€ëŠ¥ì„± ê²€ì¦
3. ê´€ë ¨ ìƒì‚° ì§€ì‹œ í™•ì¸ ë° ì·¨ì†Œ
4. ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ì·¨ì†Œ'ë¡œ ë³€ê²½
5. ì‚­ì œ ì´ë ¥ ê¸°ë¡
6. ì„±ê³µ ì‘ë‹µ ë°˜í™˜

âŒ ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤:
- ì™„ë£Œëœ ìˆ˜ì£¼ ì‚­ì œ ì‹œë„
- ì´ë¯¸ ì·¨ì†Œëœ ìˆ˜ì£¼
- ìƒì‚°ì´ 50% ì´ìƒ ì§„í–‰ëœ ìƒíƒœ

ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™:
- ë¬¼ë¦¬ì  ì‚­ì œ ê¸ˆì§€ (ë…¼ë¦¬ì  ì‚­ì œë§Œ)
- ì™„ë£Œëœ ìˆ˜ì£¼ ì‚­ì œ ê¸ˆì§€
- ìƒì‚° ì§„í–‰ë¥  50% ì´ìƒ ì‹œ ì‚­ì œ ì œí•œ
- ê´€ë ¨ ìƒì‚° ì§€ì‹œ í•¨ê»˜ ì·¨ì†Œ
- ì‚­ì œ ì´ë ¥ ë³´ì¡´ í•„ìˆ˜
```

### 5. ìˆ˜ì£¼ ì´ë ¥ ì¡°íšŒ UseCase

```typescript
ğŸ“‹ UseCase: GetOrderHistoryUseCase
ğŸ“ ì„¤ëª…: íŠ¹ì • ìˆ˜ì£¼ì˜ ëª¨ë“  ë³€ê²½ ì´ë ¥ì„ ì¡°íšŒí•˜ê³  ë¶„ì„í•œë‹¤.

ğŸ¯ ì£¼ìš” ì•¡í„°: ì˜ì—…ë‹´ë‹¹ì, ê´€ë¦¬ì, ê°ì‚¬ì
ğŸ“¥ ì…ë ¥: ìˆ˜ì£¼ ID, ì¡°íšŒ ì¡°ê±´ (í˜ì´ì§•, í•„í„°)
ğŸ“¤ ì¶œë ¥: ìˆ˜ì£¼ ê¸°ë³¸ ì •ë³´, ì´ë ¥ ëª©ë¡, í˜ì´ì§• ì •ë³´

âœ… ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤:
1. ì‚¬ìš©ìê°€ ìˆ˜ì£¼ ì´ë ¥ ì¡°íšŒ ìš”ì²­
2. ì‹œìŠ¤í…œì´ ìˆ˜ì£¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
3. ì¡°íšŒ ì¡°ê±´ì— ë”°ë¥¸ ì´ë ¥ í•„í„°ë§
4. ì´ë ¥ ëª©ë¡ì„ ì‹œê°„ìˆœìœ¼ë¡œ ì •ë ¬
5. ë³€ê²½ì‚¬í•­ ìš”ì•½ ì •ë³´ ìƒì„±
6. í˜ì´ì§• ì²˜ë¦¬í•˜ì—¬ ê²°ê³¼ ë°˜í™˜

âŒ ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤:
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìˆ˜ì£¼ ID
- ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ìì˜ ì´ë ¥ ì¡°íšŒ
- ì˜ëª»ëœ ë‚ ì§œ ë²”ìœ„ ì…ë ¥

ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™:
- ëª¨ë“  ë³€ê²½ì‚¬í•­ ì¶”ì  ë³´ì¥
- ì‹œê°„ìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
- ë³€ê²½ ì „/í›„ ê°’ ëª…í™•íˆ í‘œì‹œ
- ë³€ê²½ ì‚¬ìœ  ë° ë‹´ë‹¹ì ì •ë³´ í¬í•¨
- ê°ì‚¬ ëª©ì ì˜ ìƒì„¸ ë¡œê·¸ ì œê³µ
```

### 6. ìƒì‚° ì§€ì‹œ ìƒì„± UseCase

```typescript
ğŸ“‹ UseCase: CreateProductionOrderUseCase
ğŸ“ ì„¤ëª…: ëŒ€ê¸° ìƒíƒœì˜ ìˆ˜ì£¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒì‚° ì§€ì‹œë¥¼ ìƒì„±í•œë‹¤.

ğŸ¯ ì£¼ìš” ì•¡í„°: ìƒì‚°ê³„íšì
ğŸ“¥ ì…ë ¥: ìˆ˜ì£¼ ID, ê³„íš ì‹œì‘ì¼
ğŸ“¤ ì¶œë ¥: ìƒì‚°ì§€ì‹œë²ˆí˜¸, ì„±ê³µ ì—¬ë¶€

âœ… ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤:
1. ì‚¬ìš©ìê°€ ìƒì‚° ì§€ì‹œ ìƒì„± ìš”ì²­
2. ì‹œìŠ¤í…œì´ ìˆ˜ì£¼ ìƒíƒœ í™•ì¸ (ëŒ€ê¸° ìƒíƒœ)
3. BOM ì¡´ì¬ ì—¬ë¶€ í™•ì¸
4. ìƒì‚° ì¼ì • ë° ìš©ëŸ‰ í™•ì¸
5. ìƒì‚° ì§€ì‹œ ìƒì„±
6. ìˆ˜ì£¼ ìƒíƒœë¥¼ 'ìƒì‚°ì¤‘'ìœ¼ë¡œ ë³€ê²½
7. ì´ë ¥ ê¸°ë¡
8. ì„±ê³µ ì‘ë‹µ ë°˜í™˜

âŒ ì˜ˆì™¸ ì‹œë‚˜ë¦¬ì˜¤:
- ëŒ€ê¸° ìƒíƒœê°€ ì•„ë‹Œ ìˆ˜ì£¼
- BOMì´ ì—†ëŠ” ì œí’ˆ í¬í•¨
- ìƒì‚° ìš©ëŸ‰ ë¶€ì¡±
- ë‚©ê¸°ì¼ ëŒ€ë¹„ ì‹œê°„ ë¶€ì¡±

ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™:
- ëŒ€ê¸° ìƒíƒœì˜ ìˆ˜ì£¼ë§Œ ìƒì‚° ì§€ì‹œ ìƒì„± ê°€ëŠ¥
- ëª¨ë“  ì œí’ˆì˜ BOM ì¡´ì¬ í•„ìˆ˜
- ê³„íš ì‹œì‘ì¼ì€ í˜„ì¬ ë‚ ì§œ ì´í›„
- ë‚©ê¸°ì¼ê¹Œì§€ ì¶©ë¶„í•œ ìƒì‚° ì‹œê°„ í™•ë³´
- ìŠ¹ì¸ ê³¼ì • ì—†ì´ ì§ì ‘ ìƒì„± ê°€ëŠ¥
```

---

## ğŸ“Š í…Œì´ë¸” ê¸°ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì—…ë°ì´íŠ¸)

### âœ… í•„ìˆ˜ ê¸°ëŠ¥ (Must Have)

#### ğŸ¯ ì•¡ì…˜ ë²„íŠ¼ (ì—…ë°ì´íŠ¸)

- [x] **ìˆ˜ì • ë²„íŠ¼**: ê° í–‰ì˜ ìˆ˜ì • ì•¡ì…˜
- [x] **ì‚­ì œ ë²„íŠ¼**: ê° í–‰ì˜ ì‚­ì œ ì•¡ì…˜ (í™•ì¸ ëŒ€í™”ìƒì í¬í•¨)
- [x] **ìƒì‚°ì§€ì‹œ ë²„íŠ¼**: ëŒ€ê¸° ìƒíƒœ ìˆ˜ì£¼ì˜ ìƒì‚° ì§€ì‹œ ìƒì„± (ìŠ¹ì¸ ë‹¨ê³„ ìƒëµ)
- [x] **ìƒì„¸ë³´ê¸° ë²„íŠ¼**: ìˆ˜ì£¼ ìƒì„¸ ì •ë³´ ë° í’ˆëª© ì¡°íšŒ
- [x] **ì´ë ¥ì¡°íšŒ ë²„íŠ¼**: í•´ë‹¹ ìˆ˜ì£¼ì˜ ë³€ê²½ ì´ë ¥ ì¡°íšŒ
- [x] **ë³µì‚¬ ë²„íŠ¼**: ê¸°ì¡´ ìˆ˜ì£¼ë¥¼ ë³µì‚¬í•˜ì—¬ ì‹ ê·œ ìˆ˜ì£¼ ìƒì„±

#### ğŸ” ì»¬ëŸ¼ë³„ í•„í„°ë§ (ì—…ë°ì´íŠ¸)

- [x] **ìƒíƒœ í•„í„°**: ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ëŒ€ê¸°/ìƒì‚°ì¤‘/ì™„ë£Œ/ì·¨ì†Œ ì„ íƒ (ìŠ¹ì¸ ìƒíƒœ ì œê±°)
- [x] **ìˆ˜ì£¼ íƒ€ì… í•„í„°**: ë‚´ìˆ˜/ìˆ˜ì¶œ/ìƒ˜í”Œ/ìˆ˜ë¦¬ ë‹¤ì¤‘ ì„ íƒ
- [x] **ê³ ê°ëª… í•„í„°**: í…ìŠ¤íŠ¸ ì…ë ¥ìœ¼ë¡œ ê³ ê°ëª… í•„í„°ë§
- [x] **ìš°ì„ ìˆœìœ„ í•„í„°**: ë‹¤ì¤‘ ì„ íƒìœ¼ë¡œ ê¸´ê¸‰/ë†’ìŒ/ë³´í†µ/ë‚®ìŒ ì„ íƒ
- [x] **ì˜ì—…ë‹´ë‹¹ì í•„í„°**: ë‹´ë‹¹ìë³„ í•„í„°ë§
- [x] **ë‚ ì§œ ë²”ìœ„ í•„í„°**: ìˆ˜ì£¼ì¼, ë‚©ê¸°ì¼ ë²”ìœ„ ì„¤ì •
- [x] **ê¸ˆì•¡ ë²”ìœ„ í•„í„°**: ìµœì†Œ/ìµœëŒ€ ê¸ˆì•¡ìœ¼ë¡œ ë²”ìœ„ ì„¤ì •

---

## ğŸ¨ UI/UX ê°œì„ ì‚¬í•­

### ğŸ“± ìƒíƒœë³„ ì‹œê°ì  í‘œí˜„

- **ëŒ€ê¸°**: íŒŒë€ìƒ‰ ë°°ì§€, ì§ì ‘ ìƒì‚°ì§€ì‹œ ë²„íŠ¼ í™œì„±í™”
- **ìƒì‚°ì¤‘**: ì£¼í™©ìƒ‰ ë°°ì§€, ì§„í–‰ë¥  í‘œì‹œ
- **ì™„ë£Œ**: ë…¹ìƒ‰ ë°°ì§€, ì™„ë£Œ ë‚ ì§œ í‘œì‹œ
- **ì·¨ì†Œ**: íšŒìƒ‰ ë°°ì§€, ì·¨ì†Œ ì‚¬ìœ  íˆ´íŒ

### ğŸ¯ ì•¡ì…˜ ë²„íŠ¼ ìµœì í™”

- **ì¡°ê±´ë¶€ ë²„íŠ¼ í‘œì‹œ**: ìƒíƒœì— ë”°ë¼ ê°€ëŠ¥í•œ ì•¡ì…˜ë§Œ í‘œì‹œ
- **ì¼ê´„ ì‘ì—…**: ì²´í¬ë°•ìŠ¤ë¡œ ë‹¤ì¤‘ ì„ íƒ í›„ ì¼ê´„ ì‚­ì œ/ìƒíƒœ ë³€ê²½
- **ë¹ ë¥¸ ì•¡ì…˜**: ìš°í´ë¦­ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ë¡œ ë¹ ë¥¸ ì‘ì—… ìˆ˜í–‰

### ğŸ“Š ì´ë ¥ ì¡°íšŒ ê°•í™”

- **íƒ€ì„ë¼ì¸ ë·°**: ì‹œê°„ íë¦„ì— ë”°ë¥¸ ì‹œê°ì  ì´ë ¥ í‘œì‹œ
- **ë³€ê²½ì‚¬í•­ í•˜ì´ë¼ì´íŠ¸**: ì¤‘ìš”í•œ ë³€ê²½ì‚¬í•­ ìƒ‰ìƒ êµ¬ë¶„
- **ì´ë ¥ ìš”ì•½**: ì£¼ìš” ë³€ê²½ì‚¬í•­ë§Œ ê°„ëµíˆ í‘œì‹œí•˜ëŠ” ìš”ì•½ ëª¨ë“œ
- **ì´ë ¥ ê²€ìƒ‰**: íŠ¹ì • ë³€ê²½ì‚¬í•­ì´ë‚˜ ë‹´ë‹¹ìë¡œ ì´ë ¥ ê²€ìƒ‰

ì´ì œ MES ìˆ˜ì£¼ê´€ë¦¬ ì‹œìŠ¤í…œì´ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì—†ì´ ë” ê°„ì†Œí™”ë˜ê³  íš¨ìœ¨ì ì¸ ì›Œí¬í”Œë¡œìš°ë¥¼ ì œê³µí•˜ë©°, ê°•ë ¥í•œ ìˆ˜ì •/ì‚­ì œ/ì´ë ¥ ê´€ë¦¬ ê¸°ëŠ¥ì„ ê°–ì¶”ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ—„ï¸ Repository Interface ì •ì˜

```typescript
// domain/repositories/OrderRepository.ts
export interface OrderRepository {
  save(order: Order): Promise<void>;
  findById(id: OrderId): Promise<Order | null>;
  findByOrderNo(orderNo: string): Promise<Order | null>;
  findByPageWithCriteria(
    criteria: OrderSearchCriteria,
    page: number,
    pageSize: number
  ): Promise<Order[]>;
  findAllByCriteria(criteria: OrderSearchCriteria): Promise<Order[]>;
  countByCriteria(criteria: OrderSearchCriteria): Promise<number>;
  findByDateRange(startDate: Date, endDate: Date): Promise<Order[]>;
  getLastSequenceByPrefix(prefix: string): Promise<number>;
  findByCustomerCode(customerCode: string): Promise<Order[]>;
  findByStatus(status: OrderStatus): Promise<Order[]>;
  findDelayedOrders(): Promise<Order[]>;
  findUrgentOrders(): Promise<Order[]>;
}

export interface OrderSearchCriteria {
  searchKeyword?: string;
  filters?: OrderFilter[];
  startDate?: Date;
  endDate?: Date;
  sortBy?: string;
  sortDirection?: "asc" | "desc";
}

// domain/repositories/OrderHistoryRepository.ts
export interface OrderHistoryRepository {
  save(history: OrderHistory): Promise<void>;
  findByOrderId(orderId: OrderId): Promise<OrderHistory[]>;
  findByUserId(userId: string): Promise<OrderHistory[]>;
  findByDateRange(startDate: Date, endDate: Date): Promise<OrderHistory[]>;
}
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„ êµ¬í˜„ ê°€ì´ë“œ

### 1ì£¼ì°¨: Domain & Application Layer

```typescript
âœ… í•´ì•¼ í•  ì‘ì—…:
1. Order ì—”í‹°í‹° êµ¬í˜„
2. OrderItem ì—”í‹°í‹° êµ¬í˜„
3. OrderHistory ì—”í‹°í‹° êµ¬í˜„
4. Repository ì¸í„°í˜ì´ìŠ¤ ì •ì˜
5. 7ê°œ ì£¼ìš” UseCase êµ¬í˜„
6. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±

ğŸ“ ìƒì„±í•  íŒŒì¼:
- domain/entities/Order.ts
- domain/entities/OrderItem.ts
- domain/entities/OrderHistory.ts
- domain/entities/Customer.ts
- domain/repositories/OrderRepository.ts
- domain/repositories/OrderHistoryRepository.ts
- application/usecases/order/GetOrderListUseCase.ts
- application/usecases/order/CreateOrderUseCase.ts
- application/usecases/order/ApproveOrderUseCase.ts
- application/usecases/order/CancelOrderUseCase.ts
- application/usecases/order/CreateProductionOrderUseCase.ts
- application/usecases/order/GetOrderDashboardUseCase.ts
- application/usecases/order/ExportOrderListUseCase.ts
```

### 2ì£¼ì°¨: Infrastructure & Presentation Layer

```typescript
âœ… í•´ì•¼ í•  ì‘ì—…:
1. HTTP Repository êµ¬í˜„ì²´ ì‘ì„±
2. DI Container êµ¬ì„±
3. React ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
4. ì»¤ìŠ¤í…€ í›… êµ¬í˜„
5. ëŒ€ì‹œë³´ë“œ ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸
6. í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

ğŸ“ ìƒì„±í•  íŒŒì¼:
- infrastructure/repositories/HttpOrderRepository.ts
- config/OrderContainer.ts
- presentation/pages/OrderManagementPage.tsx
- presentation/pages/OrderDashboardPage.tsx
- hooks/useOrderTable.ts
- hooks/useOrderDashboard.ts
- components/modals/OrderFormModal.tsx
- components/modals/OrderApprovalModal.tsx
- components/charts/OrderStatusChart.tsx
- components/charts/OrderTrendChart.tsx
```

### 3ì£¼ì°¨: ê³ ê¸‰ ê¸°ëŠ¥ & í†µí•©

```typescript
âœ… í•´ì•¼ í•  ì‘ì—…:
1. ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ
2. íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
3. ê¶Œí•œ ê´€ë¦¬ ì‹œìŠ¤í…œ
4. ì„±ëŠ¥ ìµœì í™”
5. E2E í…ŒìŠ¤íŠ¸ ì‘ì„±

ğŸ“ ìƒì„±í•  íŒŒì¼:
- services/NotificationService.ts
- services/FileExportService.ts
- middleware/AuthorizationMiddleware.ts
- utils/PerformanceOptimizer.ts
- tests/e2e/OrderManagement.test.ts
```

---

## ğŸ¨ UI/UX ê³ ë ¤ì‚¬í•­

### ğŸ“± ë°˜ì‘í˜• ë””ìì¸

- ë°ìŠ¤í¬í†±: ì „ì²´ ì»¬ëŸ¼ í‘œì‹œ
- íƒœë¸”ë¦¿: ì¤‘ìš” ì»¬ëŸ¼ë§Œ í‘œì‹œ, ìƒì„¸ì •ë³´ëŠ” ëª¨ë‹¬
- ëª¨ë°”ì¼: ì¹´ë“œ í˜•íƒœë¡œ í‘œì‹œ, ìŠ¤ì™€ì´í”„ ì•¡ì…˜

### ğŸ¯ ì‚¬ìš©ì„± ê°œì„ 

- í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì§€ì› (Ctrl+N: ì‹ ê·œë“±ë¡, Ctrl+F: ê²€ìƒ‰ ë“±)
- ë¬´í•œ ìŠ¤í¬ë¡¤ ì˜µì…˜
- ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ìš°ì„ ìˆœìœ„ ë³€ê²½
- ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ (ìš°í´ë¦­ ë©”ë‰´)

### ğŸ¨ ì‹œê°ì  ê°œì„ 

- ìƒíƒœë³„ ìƒ‰ìƒ ì½”ë”©
- ì§„í–‰ë¥  ë°” (ìƒì‚° ì§„í–‰ë„)
- ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ (ìƒíƒœ ë³€ê²½ ì‹œ)
- ë‹¤í¬ ëª¨ë“œ ì§€ì›

ì´ì œ MES ìˆ˜ì£¼ê´€ë¦¬ ì‹œìŠ¤í…œì˜ í´ë¦° ì•„í‚¤í…ì²˜ ì„¤ê³„ê°€ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì œí’ˆì •ë³´ ê´€ë¦¬ì™€ ë™ì¼í•œ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ìˆ˜ì£¼ í”„ë¡œì„¸ìŠ¤ì— íŠ¹í™”ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ê¸°ëŠ¥ë“¤ì„ í¬í•¨í–ˆìŠµë‹ˆë‹¤.
